## CIDRAMのドキュメンテーション（日本語）。

### 目次
- １.[序文](#SECTION1)
- ２.[インストール方法](#SECTION2)
- ３.[使用方法](#SECTION3)
- ４.[フロントエンドの管理](#SECTION4)
- ５.[本パッケージに含まれるファイル](#SECTION5)
- ６.[コンフィギュレーション（設定オプション）](#SECTION6)
- ７.[シグネチャ（署名）フォーマット](#SECTION7)
- ８.[適合性問題](#SECTION8)
- ９.[よくある質問（ＦＡＱ）](#SECTION9)
- １０.＜ドキュメントへの将来の追加のために予約されています＞。
- １１.[法律情報](#SECTION11)

*翻訳についての注意：エラーが発生した場合（例えば、​翻訳の間の不一致、​タイプミス、​等等）、​READMEの英語版が原本と権威のバージョンであると考えられます。​誤りを見つけた場合は、​それらを修正するにご協力を歓迎されるだろう。*

---


### １.<a name="SECTION1"></a>序文

CIDRAM（シドラム、​クラスレス・ドメイン間・ルーティング・アクセス・マネージャー 『Classless Inter-Domain Routing Access Manager』）は、​ＰＨＰスクリプトです。​ウェブサイトを保護するように設計されて、​ＩＰアドレス（望ましくないトラフィックのあるソースとみなします）から、​発信リクエストをブロックすることによって（ヒト以外のアクセスエンドポイント、​クラウドサービス、​スパムロボット、​スクレーパー、​等）。​ＩＰアドレスの可能ＣＩＤＲを計算することにより、​ＣＩＤＲは、​そのシグネチャファイルと比較することができます（これらのシグネチャファイルは不要なIPアドレスに対応するCIDRのリストが含まれています）；​一致が見つかった場合、​リクエストはブロックされます。

*（参照する：​[「ＣＩＤＲ」とは何ですか？​](#WHAT_IS_A_CIDR)）。*

CIDRAM著作権2016とGNU一般公衆ライセンスv2を超える権利について：Caleb M (Maikuolan)著。

本スクリプトはフリーウェアです。​フリーソフトウェア財団発行のGNU一般公衆ライセンス・バージョン２（またはそれ以降のバージョン）に従い、​再配布ならびに加工が可能です。​配布の目的は、​役に立つことを願ってのものですが、​『保証はなく、​また商品性や特定の目的に適合するのを示唆するものでもありません』。​『LICENSE.txt』にある『GNU General Public License』（一般ライセンス）を参照して下さい。​以下のURLからも閲覧できます：
- <http://www.gnu.org/licenses/>。
- <http://opensource.org/licenses/>。

本ドキュメントならびに関連パッケージ、​[GitHub](https://cidram.github.io/)からダウンロードできます。

---


### ２.<a name="SECTION2"></a>インストール方法

#### 2.0 手動インストール

１） 本項を読んでいるということから、​アーカイブ・スクリプトのローカルマシンへのダウンロードと解凍は終了していると考えます。​ホストあるいはＣＭＳに`/public_html/cidram/`のようなディレクトリを作り、​ローカルマシンからそこにコンテンツをアップロードするのが次のステップです。​アップロード先のディレクトリ名や場所については、​安全でさえあれば、​もちろん制約などはありませんので、​自由に決めて下さい。

２） `config.ini`に`config.ini.RenameMe`の名前を変更します（`vault`の内側に位置する）。​オプションの修正のため（初心者には推奨できませんが、​経験が豊富なユーザーには強く推奨します）、​それを開いて下さい（本ファイルはCIDRAMが利用可能なディレクティブを含んでおり、​それぞれのオプションについての機能と目的に関した簡単な説明があります）。​セットアップ環境にあわせて、​適当な修正を行いファイルを保存して下さい。

３） コンテンツ（CIDRAM本体とファイル）を先に定めたディレクトリにアップロードします。​（`*.txt`や`*.md`ファイルはアップロードの必要はありませんが、​大抵は全てをアップロードしてもらって構いません）。

４） `vault`ディレクトリは「７５５」にアクセス権変更します（問題がある場合は、​「７７７」を試すことができます；これは、​しかし、​安全ではありません）。​コンテンツをアップロードしたディレクトリそのものは、​通常特に何もする必要ありませんが、​過去にパーミッションで問題があった場合、​CHMODのステータスは確認しておくと良いでしょう。​（デフォルトでは「７５５」が一般的です）。

５） 次に、​システム内あるいはＣＭＳにCIDRAMをフックします。​方法はいくつかありますが、​最も容易なのは、​`require`や`include`でスクリプトをシステム内またはＣＭＳのコアファイルの最初の部分に記載する方法です。​（コアファイルとは、​サイト内のどのページにアクセスがあっても必ずロードされるファイルのことです）。​一般的には、​`/includes`や`/assets`や`/functions`のようなディレクトリ内のファイルで、​`init.php`、​`common_functions.php`、​`functions.php`といったファイル名が付けられています。​実際にどのファイルなのかは、​見つけてもうらう必要があります。​よく分からない場合は、​CIDRAMサポートフォーラムを参照するか、​またはGitHubのでCIDRAMの問題のページ、​あるいはお知らせください（ＣＭＳ情報必須）。​私自身を含め、​ユーザーの中に類似のＣＭＳを扱った経験があれば、​何かしらのサポートを提供できます。​コアファイルが見つかったなら、​「`require`か`include`を使って」以下のコードをファイルの先頭に挿入して下さい。​ただし、​クォーテーションマークで囲まれた部分は`loader.php`ファイルの正確なアドレス（HTTPアドレスでなく、​ローカルなアドレス。​前述のvaultのアドレスに類似）に置き換えます。

`<?php require '/user_name/public_html/cidram/loader.php'; ?>`

ファイルを保存して閉じ、​再アップロードします。

-- 他の手法 --

Apacheウェブサーバーを利用していて、​かつ`php.ini`を編集できるようであれば、​`auto_prepend_file`ディレクティブを使って、​ＰＨＰリクエストがあった場合にはいつもCIDRAMを先頭に追加するようにすることも可能です。​以下に例を挙げます。

`auto_prepend_file = "/user_name/public_html/cidram/loader.php"`

あるいは、​`.htaccess`において：

`php_value auto_prepend_file "/user_name/public_html/cidram/loader.php"`

６） インストールは完了しました。​:-)

#### 2.1 COMPOSERを使用してインストールする

[CIDRAMはPackagistに登録されています](https://packagist.org/packages/cidram/cidram)。​Composerを使い慣れている場合は、​Composerを使用してCIDRAMをインストールできます （あなたはまだ設定とフックを準備する必要があります；​「手動インストール」の手順2と5を参照してください）。

`composer require cidram/cidram`

#### 2.2 WORDPRESSためにインストールする

WordPressでCIDRAMを使用する場合は、​上記の手順をすべて無視することができます。​[CIDRAMは、​WordPressプラグインデータベースにプラグインとして登録されています](https://wordpress.org/plugins/cidram/)。​プラグイン・ダッシュボードからCIDRAMを直接インストールできます。​他のプラグインと同じ方法でインストールでき、​追加手順は不要です。​他のインストール方法と同じように、​`config.ini`ファイルの内容を変更してまたはフロントエンドのコンフィギュレーションページを使用してインストールをカスタマイズすることができます。​フロントエンドのアップデート・ページでCIDRAMを更新すると、​プラグインバージョン情報がWordPressに自動的に同期されます。

*警告：プラグイン・ダッシュボードを介してCIDRAMを更新すると、​クリーン・インストールが行われます。​インストールをカスタマイズした場合（あなたの設定を変更した、​モジュールをインストールしたなど）、​これらのカスタマイズは、​プラグイン・ダッシュボードを介して更新すると、​失われます！​ログ・ファイルも失われます！​ログ・ファイルとカスタム化を保持するには、​CIDRAMフロントエンド・アップデイト・ページで更新します。*

---


### ３.<a name="SECTION3"></a>使用方法

CIDRAMは自動的に望ましくないリクエストをブロックする必要があります；支援が必要とされていません（インストールを除きます）。

あなたの設定ファイルを変更することによって、​コンフィグレーション設定をカスタマイズすることができます。​あなたのシグネチャファイルを変更することによって、​ＣＩＤＲがブロックされて変更することができます。

誤検出（偽陽性）や新種の疑わしきものに遭遇した、​関することについては何でもお知らせ下さい。 *（参照する：​[「偽陽性」とは何ですか？​](#WHAT_IS_A_FALSE_POSITIVE)）。*

CIDRAMは、手動で、または、フロントエンド経由で更新できます。​CIDRAMは、もともとそれらの手段を介してインストールされていれば、ComposerまたはWordPress経由で更新することもできます。

---


### ４.<a name="SECTION4"></a>フロントエンドの管理

#### 4.0 フロントエンドは何です。

フロントエンドは、​CIDRAMのインストールを維持、​管理、​更新するための便利で簡単な方法を提供します。​ログ・ページを使用してログファイルを表示、​共有、​ダウンロードすることができます、​コンフィギュレーションページでコンフィギュレーションを変更できます、​アップデートページを使用してコンポーネントをインストールおよびアンインストールできます、​そして、​ファイル・マネージャーを使用してvault「ボールト」内のファイルをアップロード、​ダウンロード、​および変更することができます。

不正アクセスを防止するため、​フロントエンドはデフォルトで無効になっています （不正アクセスがウェブサイトとそのセキュリティに重大な影響を与える可能性があります）。​それを可能にするための指示は、​このパラグラフの下に含まれています。

#### 4.1 フロントエンドを有効にする方法。

１） `config.ini`の中にある`disable_frontend`ディレクティブを探します、​それを「`false`」に設定します（デフォルトでは「`true`」です）。

２） ブラウザから`loader.php`にアクセスしてください（例えば、​`http://localhost/cidram/loader.php`）。

３） デフォルトのユーザー名とパスワードでログインする（admin/password）。

注意：あなたが初めてログインした後、​フロントエンドへの不正アクセスを防ぐために、​あなたはすぐにユーザー名とパスワードを変更する必要があります！​これは非常に重要です、​なぜなら、​フロントエンドから任意のＰＨＰコードをあなたのウェブサイトにアップロードすることができるからです。

#### 4.2 フロントエンドの使い方。

フロントエンドの各ページには、​目的の説明とその使用方法の説明があります。​詳しい説明や特別な支援が必要な場合は、​サポートにお問い合わせください。​また、​デモを提供するYouTube上で利用可能な動画もあります。


---


### ５.<a name="SECTION5"></a>本パッケージに含まれるファイル

以下はアーカイブから一括ダウンロードされるファイルのリスト、​ならびにスクリプト使用により作成されるファイルとこれらのファイルが何のためかという簡単な説明です。

ファイル | 説明
----|----
/_docs/ | ドキュメンテーション用のディレクトリです（様々なファイルを含みます）。
/_docs/readme.ar.md | アラビア語ドキュメンテーション。
/_docs/readme.de.md | ドイツ語ドキュメンテーション。
/_docs/readme.en.md | 英語ドキュメンテーション。
/_docs/readme.es.md | スペイン語ドキュメンテーション。
/_docs/readme.fr.md | フランス語ドキュメンテーション。
/_docs/readme.id.md | インドネシア語ドキュメンテーション。
/_docs/readme.it.md | 伊語ドキュメンテーション。
/_docs/readme.ja.md | 日本語ドキュメンテーション。
/_docs/readme.ko.md | 韓国語ドキュメンテーション。
/_docs/readme.nl.md | オランダ語ドキュメンテーション。
/_docs/readme.pt.md | ポルトガル語ドキュメンテーション。
/_docs/readme.ru.md | ロシア語ドキュメンテーション。
/_docs/readme.ur.md | ウルドゥー語ドキュメンテーション。
/_docs/readme.vi.md | ベトナム語ドキュメンテーション。
/_docs/readme.zh-TW.md | 繁体字中国語ドキュメンテーション。
/_docs/readme.zh.md | 簡体字中国語ドキュメンテーション。
/vault/ | ヴォルト・ディレクトリ（様々なファイルを含んでいます）。
/vault/fe_assets/ | フロントエンド資産。
/vault/fe_assets/.htaccess | ハイパーテキスト・アクセスファイル（この場合、​本スクリプトの重要なファイルを権限のないソースのアクセスから保護するためです）。
/vault/fe_assets/_accounts.html | フロントエンドのアカウント・ページのＨＴＭＬテンプレート。
/vault/fe_assets/_accounts_row.html | フロントエンドのアカウント・ページのＨＴＭＬテンプレート。
/vault/fe_assets/_cache.html | フロントエンドのキャッシュ・データ・ページのＨＴＭＬテンプレート。
/vault/fe_assets/_cidr_calc.html | ＣＩＤＲ計算機のＨＴＭＬテンプレート。
/vault/fe_assets/_cidr_calc_row.html | ＣＩＤＲ計算機のＨＴＭＬテンプレート。
/vault/fe_assets/_config.html | フロントエンドのコンフィギュレーションページのＨＴＭＬテンプレート。
/vault/fe_assets/_config_row.html | フロントエンドのコンフィギュレーションページのＨＴＭＬテンプレート。
/vault/fe_assets/_files.html | ファイル・マネージャのＨＴＭＬテンプレート。
/vault/fe_assets/_files_edit.html | ファイル・マネージャのＨＴＭＬテンプレート。
/vault/fe_assets/_files_rename.html | ファイル・マネージャのＨＴＭＬテンプレート。
/vault/fe_assets/_files_row.html | ファイル・マネージャのＨＴＭＬテンプレート。
/vault/fe_assets/_home.html | フロントエンドのホームページのＨＴＭＬテンプレート。
/vault/fe_assets/_ip_aggregator.html | ＩＰアグリゲータのＨＴＭＬテンプレート。
/vault/fe_assets/_ip_test.html | ＩＰテストページのＨＴＭＬテンプレート。
/vault/fe_assets/_ip_test_row.html | ＩＰテストページのＨＴＭＬテンプレート。
/vault/fe_assets/_ip_tracking.html | ＩＰトラッキング・ページのＨＴＭＬテンプレート。
/vault/fe_assets/_ip_tracking_row.html | ＩＰトラッキング・ページのＨＴＭＬテンプレート。
/vault/fe_assets/_login.html | フロントエンドのログインページのＨＴＭＬテンプレート。
/vault/fe_assets/_logs.html | フロントエンドのロゴスページのＨＴＭＬテンプレート。
/vault/fe_assets/_nav_complete_access.html | フロントエンドのナビゲーションリンクのＨＴＭＬテンプレート、​は完全なアクセスのためのものです。
/vault/fe_assets/_nav_logs_access_only.html | フロントエンドのナビゲーションリンクのＨＴＭＬテンプレート、​はログのみにアクセスのためのものです。
/vault/fe_assets/_range.html | フロントエンドの範囲テーブル・ページのＨＴＭＬテンプレート。
/vault/fe_assets/_range_row.html | フロントエンドの範囲テーブル・ページのＨＴＭＬテンプレート。
/vault/fe_assets/_sections.html | セクション・リストのＨＴＭＬテンプレート。
/vault/fe_assets/_sections_row.html | セクション・リストのＨＴＭＬテンプレート。
/vault/fe_assets/_statistics.html | フロントエンドの統計ページのＨＴＭＬテンプレート。
/vault/fe_assets/_updates.html | フロントエンドのアップデート・ページのＨＴＭＬテンプレート。
/vault/fe_assets/_updates_row.html | フロントエンドのアップデート・ページのＨＴＭＬテンプレート。
/vault/fe_assets/frontend.css | フロントエンドのＣＳＳスタイルシート。
/vault/fe_assets/frontend.dat | フロントエンドのデータベース（アカウント情報とセッション情報とキャッシュが含まれています；​フロントエンドが有効になっているときに作成）。
/vault/fe_assets/frontend.html | フロントエンドのメインテンプレートファイル。
/vault/fe_assets/icons.php | アイコン・ハンドラ（フロントエンド・ファイル・マネージャによって使用される）。
/vault/fe_assets/pips.php | ピップス・ハンドラ（フロントエンド・ファイル・マネージャによって使用される）。
/vault/fe_assets/scripts.js | フロントエンドJavaScriptデータが含まれています。
/vault/lang/ | CIDRAMの言語データを含んでいます。
/vault/lang/.htaccess | ハイパーテキスト・アクセスファイル（この場合、​本スクリプトの重要なファイルを権限のないソースのアクセスから保護するためです）。
/vault/lang/lang.ar.cli.php | ＣＬＩのアラビア語言語データ。
/vault/lang/lang.ar.fe.php | フロントエンドのアラビア語言語データ。
/vault/lang/lang.ar.php | アラビア語言語データ。
/vault/lang/lang.bn.cli.php | ＣＬＩのベンガル語言語データ。
/vault/lang/lang.bn.fe.php | フロントエンドのベンガル語言語データ。
/vault/lang/lang.bn.php | ベンガル語言語データ。
/vault/lang/lang.de.cli.php | ＣＬＩのドイツ語言語データ。
/vault/lang/lang.de.fe.php | フロントエンドのドイツ語言語データ。
/vault/lang/lang.de.php | ドイツ語言語データ。
/vault/lang/lang.en.cli.php | ＣＬＩの英語言語データ。
/vault/lang/lang.en.fe.php | フロントエンドの英語言語データ。
/vault/lang/lang.en.php | 英語言語データ。
/vault/lang/lang.es.cli.php | ＣＬＩのスペイン語言語データ。
/vault/lang/lang.es.fe.php | フロントエンドのスペイン語言語データ。
/vault/lang/lang.es.php | スペイン語言語データ。
/vault/lang/lang.fr.cli.php | ＣＬＩのフランス語言語データ。
/vault/lang/lang.fr.fe.php | フロントエンドのフランス語言語データ。
/vault/lang/lang.fr.php | フランス語言語データ。
/vault/lang/lang.hi.cli.php | ＣＬＩのヒンディー語言語データ。
/vault/lang/lang.hi.fe.php | フロントエンドのヒンディー語言語データ。
/vault/lang/lang.hi.php | ヒンディー語言語データ。
/vault/lang/lang.id.cli.php | ＣＬＩのインドネシア語言語データ。
/vault/lang/lang.id.fe.php | フロントエンドのインドネシア語言語データ。
/vault/lang/lang.id.php | インドネシア語言語データ。
/vault/lang/lang.it.cli.php | ＣＬＩの伊語言語データ。
/vault/lang/lang.it.fe.php | フロントエンドの伊語言語データ。
/vault/lang/lang.it.php | 伊語言語データ。
/vault/lang/lang.ja.cli.php | ＣＬＩの日本語言語データ。
/vault/lang/lang.ja.fe.php | フロントエンドの日本語言語データ。
/vault/lang/lang.ja.php | 日本語言語データ。
/vault/lang/lang.ko.cli.php | ＣＬＩの韓国語言語データ。
/vault/lang/lang.ko.fe.php | フロントエンドの韓国語言語データ。
/vault/lang/lang.ko.php | 韓国語言語データ。
/vault/lang/lang.nl.cli.php | ＣＬＩのオランダ語言語データ。
/vault/lang/lang.nl.fe.php | フロントエンドのオランダ語言語データ。
/vault/lang/lang.nl.php | オランダ語言語データ。
/vault/lang/lang.no.cli.php | ＣＬＩのノルウェー語言語データ。
/vault/lang/lang.no.fe.php | フロントエンドのノルウェー語言語データ。
/vault/lang/lang.no.php | ノルウェー語言語データ。
/vault/lang/lang.pt.cli.php | ＣＬＩのポルトガル語言語データ。
/vault/lang/lang.pt.fe.php | フロントエンドのポルトガル語言語データ。
/vault/lang/lang.pt.php | ポルトガル語言語データ。
/vault/lang/lang.ru.cli.php | ＣＬＩのロシア語言語データ。
/vault/lang/lang.ru.fe.php | フロントエンドのロシア語言語データ。
/vault/lang/lang.ru.php | ロシア語言語データ。
/vault/lang/lang.sv.cli.php | ＣＬＩのスウェーデン語言語データ。
/vault/lang/lang.sv.fe.php | フロントエンドのスウェーデン語言語データ。
/vault/lang/lang.sv.php | スウェーデン語言語データ。
/vault/lang/lang.th.cli.php | ＣＬＩのタイ語言語データ。
/vault/lang/lang.th.fe.php | フロントエンドのタイ語言語データ。
/vault/lang/lang.th.php | タイ語言語データ。
/vault/lang/lang.tr.cli.php | ＣＬＩのトルコ語言語データ。
/vault/lang/lang.tr.fe.php | フロントエンドのトルコ語言語データ。
/vault/lang/lang.tr.php | トルコ語言語データ。
/vault/lang/lang.ur.cli.php | ＣＬＩのウルドゥー語言語データ。
/vault/lang/lang.ur.fe.php | フロントエンドのウルドゥー語言語データ。
/vault/lang/lang.ur.php | ウルドゥー語言語データ。
/vault/lang/lang.vi.cli.php | ＣＬＩのベトナム語言語データ。
/vault/lang/lang.vi.fe.php | フロントエンドのベトナム語言語データ。
/vault/lang/lang.vi.php | ベトナム語言語データ。
/vault/lang/lang.zh-tw.cli.php | ＣＬＩの繁体字中国語言語データ。
/vault/lang/lang.zh-tw.fe.php | フロントエンドの繁体字中国語言語データ。
/vault/lang/lang.zh-tw.php | 繁体字中国語言語データ。
/vault/lang/lang.zh.cli.php | ＣＬＩの簡体字中国語言語データ。
/vault/lang/lang.zh.fe.php | フロントエンドの簡体字中国語言語データ。
/vault/lang/lang.zh.php | 簡体字中国語言語データ。
/vault/.htaccess | ハイパーテキスト・アクセスファイル（この場合、​本スクリプトの重要なファイルを権限のないソースのアクセスから保護するためです）。
/vault/.travis.php | テストのためにTravis CIによって使用される​（機能には関係のないファイルです）。
/vault/.travis.yml | テストのためにTravis CIによって使用される​（機能には関係のないファイルです）。
/vault/aggregator.php | ＩＰアグリゲータ。
/vault/cache.dat | キャッシュ・データ。
/vault/cidramblocklists.dat | Macmathanのオプションのブロックリストのメタデータ・ファイル。​フロントエンドのアップデート・ページで使用されます。
/vault/cli.php | ＣＬＩハンドラ。
/vault/components.dat | コンポーネントのメタデータ・ファイル。​フロントエンドのアップデート・ページで使用されます。
/vault/config.ini.RenameMe | CIDRAM設定ファイル；​CIDRAMの全オプション設定を記載しています。​それぞれのオプションの機能と動作手法の説明です（アクティブにするために名前を変更します）。
/vault/config.php | コンフィギュレーション・ハンドラ。
/vault/config.yaml | 設定・デフォルトス・ファイル；CIDRAMのデフォルト設定値が含まれます。
/vault/frontend.php | フロントエンド・ハンドラ。
/vault/frontend_functions.php | フロントエンド機能ファイル。
/vault/functions.php | 機能ファイル（本質的ファイル）。
/vault/hashes.dat | 受け入れられているハッシュのリスト（reCAPTCHAの機能に関連します；のみreCAPTCHAの機能が有効になっている場合に生成）。
/vault/ignore.dat | 無視ファイル（これはシグネチャセクション無視します）。
/vault/ipbypass.dat | ＩＰバイパスの一覧（reCAPTCHAの機能に関連します；のみreCAPTCHAの機能が有効になっている場合に生成）。
/vault/ipv4.dat | ＩＰｖ４のシグネチャファイル （不要なクラウドサービスと非人のエンドポイント）。
/vault/ipv4_bogons.dat | ＩＰｖ４のシグネチャファイル （ボゴン/火星ＣＩＤＲ）。
/vault/ipv4_custom.dat.RenameMe | ＩＰｖ４のカスタムシグネチャファイル（アクティブにするために名前を変更します）。
/vault/ipv4_isps.dat | ＩＰｖ４のシグネチャファイル （スパマーを持つ危険なＩＳＰ）。
/vault/ipv4_other.dat | ＩＰｖ４のシグネチャファイル （プロキシ、​ＶＰＮ、​およびその他の不要なサービスのＣＩＤＲ）。
/vault/ipv6.dat | ＩＰｖ６のシグネチャファイル （不要なクラウドサービスと非人のエンドポイント）。
/vault/ipv6_bogons.dat | ＩＰｖ６のシグネチャファイル （ボゴン/火星ＣＩＤＲ）。
/vault/ipv6_custom.dat.RenameMe | ＩＰｖ６のカスタムシグネチャファイル（アクティブにするために名前を変更します）。
/vault/ipv6_isps.dat | ＩＰｖ６のシグネチャファイル （スパマーを持つ危険なＩＳＰ）。
/vault/ipv6_other.dat | ＩＰｖ６のシグネチャファイル （プロキシ、​ＶＰＮ、​およびその他の不要なサービスのＣＩＤＲ）。
/vault/lang.php | 言語・ハンドラ。
/vault/modules.dat | モジュールのメタデータ・ファイル。​フロントエンドのアップデート・ページで使用されます。
/vault/outgen.php | 出力発生器。
/vault/php5.4.x.php | ＰＨＰ ５.４ポリフィル​（ＰＨＰ ５.４の下位互換性のために必要です。​より新しいＰＨＰバージョンのために、​削除しても安全です）。
/vault/recaptcha.php | reCAPTCHAのモジュール。
/vault/rules_as6939.php | カスタムルールは、​AS6939のためのファイル。
/vault/rules_softlayer.php | カスタムルールは、​Soft Layerのためのファイル。
/vault/rules_specific.php | カスタムルールは、​いくつかの特定のＣＩＤＲのためのファイル。
/vault/salt.dat | ソルトファイル（一部の周辺機能によって使用されます；必要な場合にのみ生成）。
/vault/template_custom.html | CIDRAMテンプレートファイル；​CIDRAMがファイルアップロードをブロックした際に作成されるメッセージのＨＴＭＬ出力用テンプレート（アップローダーが表示するメッセージ）。
/vault/template_default.html | CIDRAMテンプレートファイル；​CIDRAMがファイルアップロードをブロックした際に作成されるメッセージのＨＴＭＬ出力用テンプレート（アップローダーが表示するメッセージ）。
/vault/themes.dat | テーマのメタデータ・ファイル。​フロントエンドのアップデート・ページで使用されます。
/vault/verification.yaml | 検索エンジンとソーシャル・メディアの検証データ。
/.gitattributes | GitHubのプロジェクトファイル（機能には関係のないファイルです）。
/Changelog.txt | バージョンによる違いを記録したものです（機能には関係のないファイルです）。
/composer.json | Composer/Packagist情報（機能には関係のないファイルです）。
/CONTRIBUTING.md | プロジェクトに貢献する方法について。
/LICENSE.txt | GNU/GPLv2のライセンスのコピー（機能には関係のないファイルです）。
/loader.php | ローダー・ファイルです。​主要スクリプトのロード、​アップロード等を行います。​フックするのはまさにこれです（本質的ファイル）！
/README.md | プロジェクト概要情報。
/web.config | ASP.NET設定ファイルです（スクリプトがASP.NETテクノロジーを基礎とするサーバーにインストールされた時に`/vault`ディレクトリを権限のないソースによるアクセスから保護するためです）。

---


### ６.<a name="SECTION6"></a>コンフィギュレーション（設定オプション）
以下は`config.ini`設定ファイルにある変数ならびにその目的と機能のリストです。

#### "general" （全般、​カテゴリー）
全般的な設定。

"logfile" （ログ・ファイル）
- アクセス試行阻止の記録、​人間によって読み取り可能。​ファイル名指定するか、​無効にしたい場合は空白のままにして下さい。

"logfileApache" （ログ・ファイル・アパッチ）
- アクセス試行阻止の記録、​Apacheスタイル。​ファイル名指定するか、​無効にしたい場合は空白のままにして下さい。

"logfileSerialized" （ログ・ファイル・シリアライズ）
- アクセス試行阻止の記録、​シリアル化されました。​ファイル名指定するか、​無効にしたい場合は空白のままにして下さい。

*有用な先端：​あなたがしたい場合は、​ログファイルの名前に日付/時刻情報を付加することができます、​名前にこれらを含めることで:完全な年のため`{yyyy}`、​省略された年のため`{yy}`、​月`{mm}`、​日`{dd}`、​時間`{hh}`。*

*例:*
- *`logfile='logfile.{yyyy}-{mm}-{dd}-{hh}.txt'`*
- *`logfileApache='access.{yyyy}-{mm}-{dd}-{hh}.txt'`*
- *`logfileSerialized='serial.{yyyy}-{mm}-{dd}-{hh}.txt'`*

"truncate" （トランケート）
- ログファイルが一定のサイズに達したら切り詰めますか？​値は、​ログファイルが切り捨てられる前に大きくなる可能性があるＢ/ＫＢ/ＭＢ/ＧＢ/ＴＢ単位の最大サイズです。​デフォルト値の０ＫＢは切り捨てを無効にします （ログファイルは無期限に拡張できます）。​注：個々のログファイルに適用されます。​ログファイルのサイズは一括して考慮されません。

"log_rotation_limit" （ログ・ローテーション・リミット）
- ログ・ローテーションは、一度に存在する必要があるログ・ファイルの数を制限します。​新しいログ・ファイルが作成されると、ログ・ファイルの総数が指定された制限を超えると、指定されたアクションが実行されます。​ここで希望の制限を指定することができます。​値「0」は、ログ・ローテーションを無効にします。

"log_rotation_action" （ログ・ローテーション・アクション）
- ログ・ローテーションは、一度に存在する必要があるログ・ファイルの数を制限します。​新しいログ・ファイルが作成されると、ログ・ファイルの総数が指定された制限を超えると、指定されたアクションが実行されます。​ここで希望のアクションを指定できます。 「Delete」 = 最も古いログ・ファイルを削除して、制限を超過しないようにします。 「Archive」 = 最初にアーカイブしてから、最も古いログ・ファイルを削除して、制限を超過しないようにします。

*技術的な説明：この文脈では、「最も古い」とは「最近変更されていない」という意味です。*

"timeOffset" （タイム・オフセット）
- お使いのサーバーの時刻は、​ローカル時刻と一致しない場合、​あなたのニーズに応じて、​時間を調整するために、​あなたはここにオフセットを指定することができます。​しかし、​その代わりに、​一般的にタイムゾーンディレクティブ（あなたの`php.ini`ファイルで）を調整ーることをお勧めします、​でも時々（といった、​限ら共有ホスティングプロバイダでの作業時）これは何をすることは必ずしも可能ではありません、​したがって、​このオプションは、​ここで提供されています。​オフセット分であります。
- 例（１時間を追加します）：`timeOffset=60`

"timeFormat"
- CIDRAMで使用される日付表記形式。​Default（デフォルト設定） = `{Day}, {dd} {Mon} {yyyy} {hh}:{ii}:{ss} {tz}`.

"ipaddr" （アイピーアドレス）
- 接続リクエストのＩＰアドレスをどこで見つけるべきかについて（Cloudflareのようなサービスに対して有効）。​Default（デフォルト設定） = REMOTE_ADDR。​注意：あなたが何をしているのか、​分からない限り、​これを変更しないでください。

「ipaddr」の推奨値です：

値 | 使用
---|---
`HTTP_INCAP_CLIENT_IP` | Incapsulaリバース・プロキシ。
`HTTP_CF_CONNECTING_IP` | Cloudflareリバース・プロキシ。
`CF-Connecting-IP` | Cloudflareリバース・プロキシ（代替；上記がうまくいかない場合）。
`HTTP_X_FORWARDED_FOR` | Cloudbricリバース・プロキシ。
`X-Forwarded-For` | [Squidリバース・プロキシ](http://www.squid-cache.org/Doc/config/forwarded_for/)。
*サーバー・コンフィグレーションによって定義されます。* | [Nginxリバース・プロキシ](https://www.nginx.com/resources/admin-guide/reverse-proxy/)。
`REMOTE_ADDR` | リバース・プロキシはありません（デフォルト値）。

"forbid_on_block" （フォービッド・オン・ブロック）
- リクエストをブロックするときに、CIDRAMが送信するＨＴＴＰステータス・メッセージはどれですか？

現在サポートされている値：

ステータス・コード | ステータス・メッセージ | 説明
---|---|---
`200` | `200 OK` | デフォルト値。​最も堅牢ではありませんが、ユーザーにとって最も親切です。
`403` | `403 Forbidden` | もう少し堅牢ですが、ユーザーにとってはあまり親切ではありません。
`410` | `410 Gone` | 一部のブラウザではこのステータス・メッセージがキャッシュされ、その後はそれ以上のリクエストは送信されません。​これにより、偽陽性を解決することが困難になる可能性があります。​しかし、特定の非常に特殊なタイプのボットからの要求を減らすために、他のオプションよりも有用かもしれません。
`418` | `418 I'm a teapot` | 実際には「April Fools」の冗談を参照し「[RFC 2324](https://tools.ietf.org/html/rfc2324#section-6.5.14)」、クライアントが理解することはまずありません。​娯楽と利便性のために提供されるが、一般的に推奨されていない。
`451` | `Unavailable For Legal Reasons` | リクエストが法的な理由で主にブロックされた場合のコンテキストに適しています。​他のコンテキストでは推奨されません。
`503` | `Service Unavailable` | 最も堅牢ですが、ユーザにとっては最も親切ではありません。

"silent_mode" （サイレント・モード）
- 「アクセス拒否」ページを表示する代わりに、​CIDRAMはブロックされたアクセス試行を自動的にリダイレクトする必要がありますか？​はいの場合は、​リダイレクトの場所を指定します。​いいえの場合は、​この変数を空白のままにします。

"lang" （ラング）
- CIDRAMのデフォルト言語を設定します。

"numbers" （ナンバーズ）
- 数値の表示方法を指定します。

現在サポートされている値：

値 | これを生産する | 説明
---|---|---
`NoSep-1` | `1234567.89`
`NoSep-2` | `1234567,89`
`Latin-1` | `1,234,567.89` | デフォルト値。
`Latin-2` | `1 234 567.89`
`Latin-3` | `1.234.567,89`
`Latin-4` | `1 234 567,89`
`Latin-5` | `1,234,567·89`
`China-1` | `123,4567.89`
`India-1` | `12,34,567.89`
`India-2` | `१२,३४,५६७.८९`
`Bengali-1` | `১২,৩৪,৫৬৭.৮৯`
`Arabic-1` | `١٢٣٤٥٦٧٫٨٩`
`Arabic-2` | `١٬٢٣٤٬٥٦٧٫٨٩`
`Thai-1` | `๑,๒๓๔,๕๖๗.๘๙`

*注意：これらの値は、パッケージを超えては関連しません。​また、サポートされる値は将来変更される可能性があります。*

"emailaddr" （Ｅメール・アドレス）
- ここにＥメールアドレスを入力して、​ユーザーがブロックされているときにユーザーに送信することができます。​これはサポートと支援に使用できます（誤ってブロックされた場合、​等）。​警告：​ここに入力された電子Ｅメールアドレスは、​おそらくスパムロボットによって取得されます。​ここで提供される電子Ｅメールアドレスは、​すべて使い捨てにすることを強く推奨します（例えば、​プライマリ個人アドレスまたはビジネスアドレスを使用しない、​等）。

"emailaddr_display_style" （Ｅメール・アドレス・ディスプレイ・スタイル）
- ユーザーに電子Ｅメール・アドレスを提示することをどのように希望しますか？ "default" = クリック可能なリンク。 "noclick" = クリックできないテキスト。

"disable_cli" （ディスエイブル・シーエルアイ）
- ＣＬＩモードを無効にするか？​ＣＬＩモード（シーエルアイ・モード）はデフォルトでは有効になっていますが、​テストツール（PHPUnit等）やＣＬＩベースのアプリケーションと干渉しあう可能性が無いとは言い切れません。​ＣＬＩモードを無効にする必要がなければ、​このデレクティブは無視してもらって結構です。​`false`（偽） = ＣＬＩモードを有効にします（Default/デフォルルト）；​`true`（真） = ＣＬＩモードを無効にします。

"disable_frontend" （ディスエイブル・フロントエンド）
- フロントエンドへのアクセスを無効にするか？​フロントエンドへのアクセスは、​CIDRAMをより管理しやすくすることができます。​前記、​それはまた、​潜在的なセキュリティリスクになる可能性があります。​バックエンドを経由して管理することをお勧めします、​しかし、​これが不可能な場合、​フロントエンドへのアクセスが提供され。​あなたがそれを必要としない限り、​それを無効にします。​`false`（偽） = フロントエンドへのアクセスを有効にします；​`true`（真） = フロントエンドへのアクセスを無効にします（Default/デフォルルト）。

"max_login_attempts" （マクス・ログイン・アテンプト）
- ログイン試行の最大回数（フロントエンド）。​Default（デフォルト設定） = ５。

"FrontEndLog" （フロントエンド・ログ）
- フロントエンド・ログインの試みを記録するためのファイル。​ファイル名指定するか、​無効にしたい場合は空白のままにして下さい。

"ban_override" （バン・オーバーライド）
- 「infraction_limit」を超えたときに「forbid_on_block」を上書きしますか？​上書きするとき：ブロックされたリクエストは空白のページを返します（テンプレートファイルは使用されません）。​２００ = 上書きしない（Default/デフォルルト）。​他の値は、「forbid_on_block」の利用可能な値と同じです。

"log_banned_ips" （ログ・バンド・アイピーズ）
- 禁止されたＩＰからブロックされたリクエストをログファイルに含めますか？​True = はい（Default/デフォルルト）；​False = いいえ。

"default_dns" （ディフォールト・ディーエンエス）
- ホスト名検索に使用する、​ＤＮＳ（ドメイン・ネーム・システム）サーバーのカンマ区切りリスト。​Default（デフォルルト） = "8.8.8.8,8.8.4.4" （Google DNS）。​注意：あなたが何をしているのか、​分からない限り、​これを変更しないでください。

*参照：​[「default_dns」には何が使えますか？](#WHAT_CAN_I_USE_FOR_DEFAULT_DNS)*

"search_engine_verification" （サーチ・エンジン・ベリフィケーション）
- 検索エンジンからのリクエストを確認する必要がありますか？​検索エンジンを確認することで、​違反の最大数を超えたために検索エンジンが禁止されないことが保証されます（検索エンジンを禁止することは、​通常、​検索エンジンランキング、​ＳＥＯなどに悪影響を及ぼします）。​確認されると、​検索エンジンがブロックされることがありますが、​しかしは禁止されません。​検証されていない場合は、​違反の最大を超えた結果、​禁止される可能性があります。​さらに、​検索エンジンの検証は、​詐称された検索エンジンから保護します（これらのリクエストはブロックされます）。​True = 検索エンジンの検証を有効にする（Default/デフォルルト）；​False = 検索エンジンの検証を無効にする。

現在サポートされている：
- [Google](https://support.google.com/webmasters/answer/80553?hl=en)
- [Bing](https://blogs.bing.com/webmaster/2012/08/31/how-to-verify-that-bingbot-is-bingbot)
- Yahoo
- [Baidu (百度)](https://help.baidu.com/question?prod_en=master&class=Baiduspider)
- [Yandex (Яндекс)](https://yandex.com/support/webmaster/robot-workings/check-yandex-robots.xml)
- [DuckDuckGo](https://duckduckgo.com/duckduckbot)

"social_media_verification" （ソーシャル・メディア・ベリフィケーション）
- ソーシャル・メディアのリクエストを確認する必要がありますか？​ソーシャル・メディアの検証では、偽のソーシャル・メディア・リクエストに対する保護が提供されます（このようなリクエストはブロックされます）。​True = ソーシャル・メディア検証を有効にする（Default/デフォルルト）；​False = ソーシャル・メディア検証を無効にする。

現在サポートされている：
- [Pinterest](https://help.pinterest.com/en/articles/about-pinterest-crawler-0)
- Embedly
- [Grapeshot](https://www.grapeshot.com/crawler/)

"protect_frontend" （プロテクト・フロントエンド）
- CIDRAMによって通常提供される保護をフロントエンドに適用するかどうかを指定します。​True = はい（Default/デフォルルト）；​False = いいえ。

"disable_webfonts" （ディスエイブル・ウェブフォンツ）
- ウェブフォンツを無効にしますか？​True = はい（Default/デフォルルト）；​False = いいえ。

"maintenance_mode" （メンテナンス・モード）
- メンテナンス・モードを有効にしますか？​True = はい；​False = いいえ（Default/デフォルルト）。​フロントエンド以外のすべてを無効にします。​ＣＭＳ、フレームワークなどを更新するときに便利です。

"default_algo" （ディフォールト・アルゴ）
- 将来のすべてのパスワードとセッションに使用するアルゴリズムを定義します。​オプション：​PASSWORD_DEFAULT（Default/デフォルルト）、​PASSWORD_BCRYPT、​PASSWORD_ARGON2I ​（ＰＨＰ >= 7.2.0 が必要）。

"statistics" （スタティスティックス/統計）
- CIDRAM使用統計を追跡しますか？​True = はい；​False = いいえ（Default/デフォルルト）。

"force_hostname_lookup" （フォース・ホストネーム・ルックアップ）
- ホスト名検索を強制しますか？​True = はい；​False = いいえ（Default/デフォルルト）。​ホスト名検索は、通常、「必要に応じて」実行されますが、すべてのリクエストに対して強制することができます。​これは、より詳細な情報をログファイルに提供する手段として有用ですが、パフォーマンスに多少の悪影響を及ぼすこともあります。

"allow_gethostbyaddr_lookup" （アラウ・「ゲット・ホーストバイ・エイ・ディ・ディ・アー」・ルックアップ）
- ＵＤＰが利用できない場合、gethostbyaddrルックアップを許可しますか？​True = はい（Default/デフォルルト）；​False = いいえ。
- *注：一部の３２ビットシステムでＩＰｖ６検索が正しく機能しないことがあります。*

"hide_version" （ハイド・バージョン）
- ログとページ出力からバージョン情報を隠すか？​True = はい；​False = いいえ（Default/デフォルルト）。

#### "signatures" （シグネチャーズ、​カテゴリ）
シグネチャの設定。

"ipv4" （アイピーブイ４）
- ＩＰｖ４のシグネチャファイルのリスト（CIDRAMは、​これを使用します）。​これは、​カンマで区切られています。​必要に応じて、​項目を追加することができます。

"ipv6" （アイピーブイ６）
- ＩＰｖ６のシグネチャファイルのリスト（CIDRAMは、​これを使用します）。​これは、​カンマで区切られています。​必要に応じて、​項目を追加することができます。

"block_cloud" （ブロック・クラウド）
- クラウドサービスからのＣＩＤＲをブロックする必要がありますか？​あなたのウェブサイトからのＡＰＩサービスを操作する場合、​または、​あなたがウェブサイトツーサイト接続が予想される場合、​これはfalseに設定する必要があります。​ない場合は、​これをtrueに設定する必要があります。

"block_bogons" （ブロック・ぼごん）
- 火星の/ぼごんからのＣＩＤＲをブロックする必要がありますか？​あなたがローカルホストから、​またはお使いのＬＡＮから、​ローカルネットワーク内からの接続を受信した場合、​これはfalseに設定する必要があります。​ない場合は、​これをtrueに設定する必要があります。

"block_generic" （ブロック・ジェネリック）
- 一般的なＣＩＤＲをブロックする必要がありますか？​（他のオプションに固有ではないもの）。

"block_legal" （ブロック・リーガル）
- 法的義務に対応してＣＩＤＲをブロックするか？​CIDRAMは、どんなＣＩＤＲをデフォルトで「法的義務」に関連付けることはないため、このディレクティブは通常は効果がありません。​しかし、それは法的理由のために存在する可能性のある任意のカスタム・シグネチャ・ファイルまたはモジュールの利益のための追加の制御手段として存在する。

"block_malware" （ブロック・マルウェア）
- マルウェアに関連するＩＰをブロックするか？​これには、Ｃ＆Ｃサーバー、感染マシン、マルウェア配布に関係するマシンなどが含まれます。

"block_proxies" （ブロック・プロキシ）
- プロキシサービスまたはＶＰＮからのＣＩＤＲをブロックする必要がありますか？​プロキシサービスまたはＶＰＮが必要な場合は、​これをfalseに設定する必要があります。​ない場合は、​セキュリティを向上させるために、​これをtrueに設定する必要があります。

"block_spam" （ブロック・スパム）
- スパムのため、​ＣＩＤＲをブロックする必要がありますか？​問題がある場合を除き、​一般的には、​これをtrueに設定する必要があります。

"modules" （モジュールス）
- ＩＰｖ４/ＩＰｖ６シグネチャをチェックした後にロードするモジュールファイルのリスト。​これは、​カンマで区切られています。

"default_tracktime" （デフォルト・トラックタイム）
- モジュールによって禁止されているＩＰを追跡する秒数。​Default（デフォルト設定） = ６０４８００（１週間）。

"infraction_limit" （インフラクション・リミット）
- ＩＰがＩＰトラッキングによって禁止される前に発生することが、​許される違反の最大数。​Default（デフォルト設定） = １０。

"track_mode" （トラック・モード）
- 違反はいつカウントされるべきですか？​False = ＩＰがモジュールによってブロックされている場合。​True = なんでもの理由でＩＰがブロックされた場合。

#### "recaptcha" （リーキャプチャ、​カテゴリ）
ユーザーにとって、​reCAPTCHAインスタンスを完成させることによって、​「アクセス拒否」ページをバイパスする方法を提供することができます。​これは、​偽陽性に関連するいくつかのリスクを緩和するのに役立ちます （リクエストが機械または人間から、​生じたものであるかどうかは不明である場合）。

「アクセス拒否」ページをバイパスすることに伴うリスクがあります。​このため、​一般的に、​必要な場合を除いて、​この機能を有効にすることはお勧めしません。​それが必要な状況：​ユーザーはあなたのウェブサイトにアクセスする必要があります、​しかし、​彼らは敵対的なネットワークから接続しています、​そして、​これは交渉できません；​ユーザーはアクセスが必要です、​敵対的なネットワークを拒絶する必要がある（何をすべきか？​！​）。​。​このような状況では、​reCAPTCHA機能が役立つ可能性があります：​ユーザーはアクセス権を持つことができます；​望ましくないトラフィックをフィルタリングすることができます（一般的に）。​人間以外のトラフィックに対しても有効です（例えば、​スパムロボット、​スクレーパー、​ハックツール、​自動交通、​など）、​しかし、​人間のトラフィックにあまり役に立たない（例えば、​人間のスパマー、​ハッカー、​その他）。

「site key」および「secret key」を得るために（reCAPTCHAのを使用するために必要）、​このリンクをクリックしてください：​[https://developers.google.com/recaptcha/](https://developers.google.com/recaptcha/)

"usemode" （ユース・モード）
- reCAPTCHAをCIDRAMで使用する方法。
- ０ = reCAPTCHAは、​無効になっています（Default/デフォルルト）。
- １ = reCAPTCHAは、​すべてのためにシグネチャが有効になっています。
- ２ = 特別にマークされたセクションの場合のみ、​reCAPTCHAが有効になります。
- （それ以外の値は０と等価です）。

"lockip" （ロック・ＩＰ）
- reCAPTCHAをＩＰにロックしますか？​False = クッキーとハッシュは複数のＩＰで使用できます（Default/デフォルルト）。​True = クッキーとハッシュは複数のＩＰで使用できません（クッキーとハッシュはIPにロックされています）。
- 注意：「lockuser」が「false」の場合、​「lockip」の値は無視されます。​これは、​ユーザーを覚えておくメカニズムがこの値に依存するためです。

"lockuser" （ロック・ユーザー）
- reCAPTCHAをユーザーにロックしますか？​False = reCAPTCHAの完了により、​責任あるＩＰ（注：ユーザーではない）から発信されたすべてのリクエストへのアクセスが許可されます；​クッキーとハッシュは使用されていません；​ＩＰホワイトリストが使用されます。​True = reCAPTCHAの完了により、​責任あるユーザー（注：ＩＰではない）から発信されたすべてのリクエストへのアクセスが許可されます；​クッキーとハッシュはユーザーを思い出すために使用されます；​ＩＰホワイトリストは使用されません（Default/デフォルルト）。

"sitekey" （サイト・キー）
- この値は、​あなたのreCAPTCHAのための「site key」に対応している必要があり；​これは、​reCAPTCHAのダッシュボードの中に見つけることができます。

"secret" （シークレット）
- この値は、​あなたのreCAPTCHAのための「secret key」に対応している必要があり；​これは、​reCAPTCHAのダッシュボードの中に見つけることができます。

"expiry" （シークレット）
- 「lockuser」が「true」とき（Default「デフォルルト」）、​reCAPTCHAインスタンスの合格/不合格態を覚えておくために、​将来のページリクエスト用、​CIDRAMは、​ハッシュを含む標準のHTTP Cookie（クッキー）を生成します；​このハッシュは、​同じハッシュを含む内部レコードに対応します；​将来のページリクエストでは、​対応するハッシュを使用して合格/不合格の状態を認証します。​「lockuser」が「false」とき、​リクエストを許可する必要があるかどうかを判断するために、​ＩＰホワイトリストが使用されます；​reCAPTCHAインスタンスが正常に渡されると、​このホワイトリストにエントリが追加されます。​これらのクッキー、​ハッシュ、​ホワイトリストのエントリは何時間有効であるべきですか？​Default（デフォルルト） = ７２０（１ヶ月）。

"logfile" （ログ・ファイル）
- reCAPTCHA試行の記録。​ファイル名指定するか、​無効にしたい場合は空白のままにして下さい。

*有用な先端：​あなたがしたい場合は、​ログファイルの名前に日付/時刻情報を付加することができます、​名前にこれらを含めることで:完全な年のため`{yyyy}`、​省略された年のため`{yy}`、​月`{mm}`、​日`{dd}`、​時間`{hh}`。*

*例:*
- *`logfile='recaptcha.{yyyy}-{mm}-{dd}-{hh}.txt'`*

"signature_limit" （シグネチャ・リミット）
- reCAPTCHAインスタンスが提供されるときにトリガされることができるシグネチャの最大数。​Default/デフォルルト = １。​特定のリクエストに対してこの数を超えると、reCAPTCHAインスタンスは提供されません。

"api" （エイ・ピー・アイ）
- どのＡＰＩを使用するのですか？​「V2」または「invisible」？

*欧州連合（ＥＵ）のユーザーのための注意：​Cookie（クッキー）を使用するようにCIDRAMが設定されている場合（「lockuser」がtrueの場合など）、[ＥＵクッキー法](http://ec.europa.eu/ipg/basics/legal/cookies/index_en.htm)の要件に従って、Cookieの警告がページに目立つように表示されます。​ただし、不可視ＡＰＩを使用する場合、CIDRAMはユーザーのreCAPTCHAを自動的に完了しようとします。​成功すると、ページがリロードされ、クッキーが実際に表示されるのに十分な時間が与えられずにクッキーが作成される可能性があります。​これが法的リスクをもたらす場合は、「invisible API」の代わりに「V2 API」を使用する方がよい場合があります​（「V2 API」は自動化されておらず、ユーザーがreCAPTCHAチャレンジ自体を完了する必要があるため、Cookie警告を表示する機会が与えられます）。*

#### "legal" （リーガル、​カテゴリ）
法律要件に関するコンフィギュレーション。

*法律要件とこれがコンフィギュレーション要件に与える影響の詳細については、ドキュメントの「[法律情報](#SECTION11)」セクションを参照してください。*

"pseudonymise_ip_addresses" （プセユードニマイズ・アイピー・アドレセズ）
- ログ・ファイルを書き込むときにIPアドレス偽名化するか「プセユードニマイズ」？​True = はい；​False = いいえ（Default/デフォルルト）。

"omit_ip" （オミット・アイピー）
- ログからＩＰアドレスを省略しますか？​True = はい；​False = いいえ（Default/デフォルルト）。​注：「omit_ip」が「true」の場合、「pseudonymise_ip_addresses」は冗長になります。

"omit_hostname" （オミット・ホストネーム）
- ログからホスト名を省略しますか？​True = はい；​False = いいえ（Default/デフォルルト）。

"omit_ua" （オミット・ユーエイ）
- ログからユーザー・エージェント（ユーエイ）を省略しますか？​True = はい；​False = いいえ（Default/デフォルルト）。

"privacy_policy" （プライバシー・ポリシー）
- 生成されたページのフッターに表示される関連プライバシー・ポリシーのアドレス。​ＵＲＬを指定するか、無効にしたい場合は空白のままにして下さい。

#### "template_data" （テンプレート・データ、​カテゴリ）
テンプレートとテーマ用のディレクティブと変数。

テンプレートのデータは、​ユーザーに向けてアクセス拒否のメッセージをＨＴＭＬ形式でアウトプットする際に使用されます。​カスタムテーマを使っている場合は`template_custom.html`を使用して、​そうでない場合は`template.html`を使用してＨＴＭＬアウトプットが生成されます。​設定ファイル内にあるこのセクション用の変数は、​ＨＴＭＬアウトプットのために解析され、​で囲まれた変数名は対応する変数データに置き換えられます。​例えば`foo="bar"`とすると、​ＨＴＭＬアウトプット内の`<p>{foo}</p>`は`<p>bar</p>`となります。

"theme" （シーム/テーマ）
- CIDRAMに使用するデフォルトテーマ。

"Magnification" （マグニフィケーション）
- フォントの倍率。​Default/デフォルルト = １。

"css_url" （シーエスエス・ユーアールエル）
- カスタムテーマ用のテンプレートファイルは、​外部ＣＳＳプロパティーを使っています。​一方、​デフォルトテーマは内部ＣＳＳです。​カスタムテーマを適用するためには、​ＣＳＳファイルのパブリックＨＴＴＰアドレスを"css_url"変数を使って指定して下さい。​この変数が空白であれば、​デフォルトテーマが適用されます。

---


### ７.<a name="SECTION7"></a>シグネチャ（署名）フォーマット

*参照：*
- *[「シグネチャ」とは何ですか？](#WHAT_IS_A_SIGNATURE)*

#### 7.0 基本原則 （シグネチャ・ファイルの場合）

CIDRAMで使用されるシグネチャの形式と構造の説明は、​カスタム・シグネチャ・ファイル内に記載されています。​詳細については、​ドキュメントを参照してください。

すべてのＩＰｖ４シグネチャはこの形式に従います：​`xxx.xxx.xxx.xxx/yy 「機能」 「パラメータ」`
- `xxx.xxx.xxx.xxx`は、​ＣＩＤＲブロックの先頭を表します（ブロックの最初のＩＰアドレスのオクテット）。
- `yy`は、​ブロックサイズを表します（１ー３２）。
- `「機能」`は、​スクリプトにシグネチャの処理方法を指示します。
- `「パラメータ」`は、​`「機能」`で必要、​な追加情報を表します。

すべてのＩＰｖ６シグネチャはこの形式に従います：​`xxxx:xxxx:xxxx:xxxx::xxxx/yy 「機能」 「パラメータ」`
- `xxxx:xxxx:xxxx:xxxx::xxxx`は、​ＣＩＤＲブロックの先頭を表します（ブロックの最初のＩＰアドレスのオクテット）。​完全表記と省略表記の両方が可能です。​彼らはＩＰｖ６仕様に準拠する必要があります、​1つの例外を除いて：​CIDRAMでは、​ＩＰｖ６アドレスは省略で始めることはできません。​例えば：​`::1/128`は`0::1/128`、​そして`::0/128`は`0::/128`と表す必要があります。
- `yy`は、​ブロックサイズを表します（１ー１２８）。
- `「機能」`は、​スクリプトにシグネチャの処理方法を指示します。
- `「パラメータ」`は、​`「機能」`で必要、​な追加情報を表します。

シグネチャファイルの改行はUnix標準を使用すべきです （`%0A`、​`\n`）。​他の標準も使用できますが、​推奨されません （例えば、​Windowsの`%0D%0A`、​`\r\n`、​Macの`%0D`、​`\r`、​等）。​非UNIX改行は正規化されます。

正確で正しいＣＩＤＲ表記が必要です。​スクリプトは、​不正確な表記（または、​不正確な表記を伴うシグネチャ）を認識しません。​さらに、​すべてのＣＩＤＲは、​均等に割り切れる必要があります（例えば、​`10.128.0.0`から`11.127.255.255`までのすべてをブロックしたい場合、​`10.128.0.0/8`はスクリプトによって認識されません、​しかし、​`10.128.0.0/9`と`11.0.0.0/9`を組み合わせて使用するとは、​スクリプトによって認識されます）。

スクリプトによって認識されないシグネチャファイル内のものは無視されます。​つまり、​シグネチャファイルを破損することなく、​ほぼすべてのデータをシグネチャファイルに安全に入れることができます。​シグネチャファイルのコメントは受け入れ可能です。​特殊な書式設定は必要ありません。​シェル形式のハッシュが推奨されますが、​強制はされません（シェルスタイルのハッシングは、​IDEやプレーンテキストエディタに役立ちます）。

「機能」の可能な値：
- Run
- Whitelist
- Greylist
- Deny

「Run」を使用すると、​シグネチャがトリガーされると、​スクリプトは`require_once`ステートメントによって（`「パラメータ」`値で指定されます）外部のＰＨＰスクリプトの実行を試みます。​作業ディレクトリは「`/vault/`」ディレクトリです。

例：​`127.0.0.0/8 Run example.php`

特定のＩＰ/ＣＩＤＲに対して特定のＰＨＰコードを実行する場合に便利です。

「Whitelist」を使用すると、​シグネチャがトリガーされると、​スクリプトはすべての検出をリセットします（何かの検出があった場合）、​テスト機能を終了します。​`「パラメータ」`は無視されます。​これは、​ＩＰまたはＣＩＤＲをホワイトリストに登録するのと同じです。

例：​`127.0.0.1/32 Whitelist`

「Greylist」を使用すると、​シグネチャがトリガーされると、​スクリプトはすべての検出をリセットします（何かの検出があった場合）、​処理を続行するために次のシグネチャファイルにスキップする。​`「パラメータ」`は無視されます。

例：​`127.0.0.1/32 Greylist`

「Deny」を使用すると、​シグネチャがトリガーされると、​保護されたページへのアクセスは拒否されます（ＩＰ/ＣＩＤＲがホワイトリストに登録されていない場合）。​「Deny」は、​実際にＩＰアドレスとＣＩＤＲの範囲をブロックするために使用するものです。​「Deny」を使用するシグネチャがトリガーされると、​「アクセス拒否」ページが生成され、​保護されたページへのリクエストが終了します。

「Deny」によって受け入れられた`「パラメータ」`値は、​「アクセス拒否」ページ出力に処理されます、​リクエストされたページへのアクセスが拒否された理由として、​クライアント/ユーザーに提供されます。​それは短くて簡単な文章にすることができます（なぜそれらをブロックすることを選択したのか説明するために）。​また、​略語とすることもできます（事前準備された説明をクライアント/ユーザに提供する）。

あらかじめ用意された説明にはL10Nのサポートがあり、​スクリプトで翻訳することができます。​翻訳は、​スクリプト・コンフィグレーションの`lang`ディレクティブを使用して指定した言語に基づいて行われます。​さらに、​これらの短縮形の単語を使用している場合、​`「パラメータ」`値に基づいて 「Deny」シグネチャを無視するようスクリプトに指示できます。​これは、​スクリプト設定で指定されたディレクティブを介して行われます（それぞれの省略形に対応するディレクティブがあります）。​ただし、​他の`「パラメータ」`値にはL10Nがサポートされていません（したがって、​他の値は翻訳されません、​そしてコンフィグレーションによって制御可能ではない）。

略語：
- Bogon
- Cloud
- Generic
- Proxy
- Spam
- Legal
- Malware

#### 7.1 タグ

##### 7.1.0 セクション・タグ

セクション名と「セクション・タグ」を追加することにより、​スクリプトに対する個々のセクションを識別することができます（以下の例を参照してください）。

```
# セクション１。
1.2.3.4/32 Deny Bogon
2.3.4.5/32 Deny Cloud
4.5.6.7/32 Deny Generic
5.6.7.8/32 Deny Spam
6.7.8.9/32 Deny Proxy
Tag: セクション１
```

セクション・タグを終了し、​シグネチャセクションが誤って識別されないようにするには、​タグと前のセクションの間に少なくとも２つの改行が連続していることを確認してください。​タグなしシグネチャは、​デフォルトで「ＩＰｖ４」または「ＩＰｖ６」のいずれかになります（どのタイプのシグネチャがトリガされているかに応じて）。

```
1.2.3.4/32 Deny Bogon
2.3.4.5/32 Deny Cloud

4.5.6.7/32 Deny Generic
5.6.7.8/32 Deny Spam
Tag: セクション１
```

上記の例で、​`1.2.3.4/32`と`2.3.4.5/32`は、​「ＩＰｖ４」でタグ付けされま；す一方、​`4.5.6.7/32`と`5.6.7.8/32`は、​「セクション１」でタグ付けされま。

他のタイプのタグの分離にも同じロジックを適用することができます。

セクション・タグは、偽陽性が発生した場合のデバッグに非常に役立ちます。​彼らが、問題の正確な原因を簡単に見つける方法を提供します。​フロントエンド・ログ・ページからログ・ファイルを表示するときに、ログ・ファイル・エントリをフィルタリングするのに非常に役立ちます（セクション名はフロントエンド・ログ・ページでクリック可能で、フィルタリング基準として使用できます）。​一部の特定のシグネチャで、セクション・タグが省略されている場合、シグネチャがトリガーされると、CIDRAMはシグネチャ・ファイルの名前とブロックされたＩＰアドレス（ＩＰｖ４またはＩＰｖ６）のタイプをフォールバックとして使用します。​したがって、セクション・タグは完全にオプションです。​しかし、シグネチャ・ファイルの名前が曖昧である場合や、要求をブロックする原因となるシグネチャのソースを明確に特定することが困難な場合など、いくつかのケースで推奨される場合があります。

##### 7.1.1 期限タグ

「期限タグ」を使用して、​シグネチャの有効期限を指定することができます。​期限切れのタグがこの形式を使用します：​「年年年年.月月.日日」 （以下の例を参照してください）。

```
# セクション１。
1.2.3.4/32 Deny Generic
2.3.4.5/32 Deny Generic
Expires: 2016.12.31
```

有効期限が切れたシグネチャは、どの要求に対してもトリガされません。

##### 7.1.2 原点タグ

特定シグネチャの原点国を指定する場合は、「原点タグ」を使用してすることができます。​起点タグは、「[ISO 3166-1 Alpha-2](https://ja.wikipedia.org/wiki/ISO_3166-1)」コードを受け入れます。​このコードは、該当するシグネチャの原点国に対応しています。​これらのコードは、大文字で書く必要があります（小文字または大文字と小文字が混在すると正しく表示されません）。原点タグが使用されると、関連するブロックされた要求の「なぜブロックされましたか」ログ項目に追加されます。

オプションの「flags CSS」コンポーネントがインストールされている場合、フロントエンド・ログ・ページでログ・ファイルを表示するとき、原点タグによって追加された情報は対応する国旗に置き換えられます。​この情報は、生の形態であろうと国旗であろうと、クリック可能である。​クリックすると、同様のログ・エントリに従ってログ・エントリがフィルタリングされます（これにより、原点国のフィルタリングが可能になります）。

注：技術的には、これは積極的に特定の位置情報を求めていないため、ジオロケーションではありません。​代わりに、これにより、特定シグネチャの原産国を明示することができます。​同じシグネチャ・セクション内で複数の原点タグを使用することができます。

仮説的な例：

```
1.2.3.4/32 Deny Generic
Origin: CN
2.3.4.5/32 Deny Generic
Origin: FR
4.5.6.7/32 Deny Generic
Origin: DE
6.7.8.9/32 Deny Generic
Origin: US
Tag: Foobar
```

任意のタグを組み合わせて使用することができ、すべてのタグはオプションです​（以下の例を参照してください）。

```
# 例セクション。
1.2.3.4/32 Deny Generic
Origin: US
Tag: 例セクション
Expires: 2016.12.31
```

#### 7.2 YAML

##### 7.2.0 YAML基本原則

セクション固有の設定を定義するために、​シンプルな形式のYAMLマークアップをシグネチャファイルで使用することができます。​これは、​異なるシグネチャセクションに対して異なる設定を行う場合に便利です （例えば：​サポートチケットのＥメールアドレスを指定したい場合は、​しかし特定のセクションのみ；​特定のシグネチャでページリダイレクトをトリガーしたい場合は；​reCAPTCHAで使用するためにシグネチャセクションをマークしたい場合は；​個々のシグネチャに基づいて、​そして/または、​シグネチャセクションに基づいて、​ブロックされたアクセス試行を別々のファイルに記録したい場合は）。

シグネチャファイルでのYAMLマークアップの使用はオプションです（即ち、​あなたが望むならそれを使うことができますが、​そうする必要はありません）。​大部分の（しかしすべてではない）コンフィグレーション・ディレクティブを活用することができます。

注意：CIDRAMにおけるYAMLマークアップの実装は非常に単純化されており、​非常に制限されています。​これは、​YAMLマークアップに精通した方法で、​しかし公式仕様書に従ったり準拠したりすることはない、​CIDRAMに固有の要件を満たすことを意図しています（他の実装と同じように動作しない可能性があり、​そして他のプロジェクトには適していない可能性があります）。

CIDRAMでは、​YAMLマークアップセグメントはスクリプトに対して３つのダッシュで（「---」）識別されます。​YAMLマークアップセグメントは、​二重改行によってシグネチャセクションと一緒に終了します。​典型的なセグメントは、​ＣＩＤＲとタグのリストの直後の行に３つのダッシュでコンフィグレーションされ、​続いて２次元のキーと値のペアのリストが続きます。​（１番目のディメンションは、​設定ディレクティブのカテゴリです；２番目のディメンションは、​設定ディレクティブです）。​以下の例を参照してください。

```
# Foobar 1.
1.2.3.4/32 Deny Generic
2.3.4.5/32 Deny Generic
4.5.6.7/32 Deny Generic
Tag: Foobar 1
---
general:
 logfile: logfile.{yyyy}-{mm}-{dd}.txt
 logfileApache: access.{yyyy}-{mm}-{dd}.txt
 logfileSerialized: serial.{yyyy}-{mm}-{dd}.txt
 forbid_on_block: false
 emailaddr: username@domain.tld
recaptcha:
 lockip: false
 lockuser: true
 expiry: 720
 logfile: recaptcha.{yyyy}-{mm}-{dd}.txt
 enabled: true
template_data:
 css_url: http://domain.tld/cidram.css

# Foobar 2.
1.2.3.4/32 Deny Generic
2.3.4.5/32 Deny Generic
4.5.6.7/32 Deny Generic
Tag: Foobar 2
---
general:
 logfile: "logfile.Foobar2.{yyyy}-{mm}-{dd}.txt"
 logfileApache: "access.Foobar2.{yyyy}-{mm}-{dd}.txt"
 logfileSerialized: "serial.Foobar2.{yyyy}-{mm}-{dd}.txt"
 forbid_on_block: 503

# Foobar 3.
1.2.3.4/32 Deny Generic
2.3.4.5/32 Deny Generic
4.5.6.7/32 Deny Generic
Tag: Foobar 3
---
general:
 forbid_on_block: 403
 silent_mode: "http://127.0.0.1/"
```

##### 7.2.1 reCAPTCHAで使用するためにシグネチャセクションをマークする方法。

「usemode」が０または１の場合、​reCAPTCHAで使用するために、​シグネチャセクションをマークする必要はありません（reCAPTCHAを使用するかどうかは既に決定されているためです）。

「usemode」が２の場合、​reCAPTCHAで使用するためにシグネチャセクションをマークするには、​そのシグネチャセクションのYAMLマーカーセグメントを含めてください（以下の例を参照してください）。

```
# このセクションでは、​reCAPTCHAのを使用します。
1.2.3.4/32 Deny Generic
2.3.4.5/32 Deny Generic
Tag: reCAPTCHA-Enabled
---
recaptcha:
 enabled: true
```

*注意：​デフォルトでは、reCAPTCHAインスタンスは、​reCAPTCHAが有効な場合にのみユーザーに提供されます（「usemode」が１のとき、​または、​「usemode」が２と「enabled」が「true」のとき）、​そして、​厳密に１つのシグネチャがトリガされた場合（より大きい数ない、​より小さい数ない；複数のシグネチャがトリガーされた場合、​reCAPTCHAインスタンスは提供されません）。​ただし、この動作は「signature_limit」ディレクティブで変更できます。*

#### 7.3 補助

さらに、​CIDRAMに特定のシグネチャセクションを完全に無視させたい場合、​「`ignore.dat`」ファイルを使用して、​無視するセクションを指定することができます。​新しい行に`Ignore`と書いてください、​次に、​スペース、​次に、​CIDRAMが無視するセクションの名前（以下の例を参照してください）。

```
Ignore セクション１
```

#### 7.4 <a name="MODULE_BASICS"></a>基本原則 （モジュールの場合）

モジュールを使用して、CIDRAMの機能を拡張したり、追加のタスクを実行したり、追加ロジックを処理することができます。​通常は、発信元ＩＰアドレス以外のリクエストをブロックする必要がある場合に使用されます​（したがって、ＣＩＤＲシグネチャがリクエストをブロックするのに十分でない場合）。​モジュールはＰＨＰファイルとして記述されるため、通常、モジュール・シグネチャはＰＨＰコードとして記述されます。

CIDRAMモジュールのいくつかの良い例がここにあります：
- https://github.com/CIDRAM/CIDRAM-Extras/tree/master/modules

新しいモジュールを書くためのテンプレートは、ここで見つけることができます：
- https://github.com/CIDRAM/CIDRAM-Extras/blob/master/modules/module_template.php

モジュールはＰＨＰファイルとして記述されているため、CIDRAMコードベースを十分に理解している場合は、必要に応じてモジュールとモジュール・シグネチャを構造化できます（ＰＨＰで可能なことを理由に）。​ただし、既存のモジュールと独自のモジュールとの間の相互明瞭性を高めるために、上記のリンクされたテンプレートを分析することをお勧めします。​これは、提供する構造とフォーマットを使用できるようにするためです。

*注意：​ＰＨＰコードの操作に慣れていない場合は、独自のモジュールを作成することはお勧めしません。*

CIDRAMは、独自のモジュールを簡単かつ簡単に作成できる機能を提供しています。​この機能に関する情報は、以下で説明します。

#### 7.5 モジュール機能

##### 7.5.0 "$Trigger"

モジュール・シグネチャは、通常、「$Trigger」で記述されます。​ほとんどの場合、このクロージャ（closure）はモジュールを書く目的のために何よりも重要になります。

「$Trigger」は４つのパラメータを受け取ります：​「$Condition」、「$ReasonShort」、「$ReasonLong」（オプショナル）、「$DefineOptions」（オプショナル）。

「$Condition」の真実性が評価されます。​真の場合（true）、シグネチャはトリガーされます。​偽の場合（false）、シグネチャはトリガーされません。​「$Condition」には通常、リクエストをブロックする条件を評価するためのＰＨＰコードが含まれています。

シグネチャがトリガーされると、「なぜブロックされましたか」フィールドに「$ReasonShort」が引用されます。

「$ReasonLong」は、ユーザー/クライアントがブロックされたときにそれらがブロックされた理由を説明するためにユーザー/クライアントに表示されるオプションのメッセージです。​省略された場合、標準の「アクセス拒否」メッセージを使用します。

「$DefineOptions」は、オプショナル・キーと値のペアを含む配列です。​これは、リクエスト・インスタンスに固有の設定オプションを定義するために使用されます。​設定オプションは、シグネチャがトリガーされたときに適用されます。

「$Trigger」は、シグネチャがトリガされたときに真（true）を返し、そうでないときに偽（false）を返します。

このクロージャをモジュールで使用するには、最初に親スコープから継承することを忘れないでください：
```PHP
$Trigger = $CIDRAM['Trigger'];
```

##### 7.5.1 "$Bypass"

シグネチャ・バイパスは、通常、「$Bypass」で記述されます。

「$Bypass」は３つのパラメータを受け取ります：​「$Condition」、「$ReasonShort」、「$DefineOptions」（オプショナル）。

「$Condition」の真実性が評価されます。​真の場合（true）、バイパスはトリガーされます。​偽の場合（false）、バイパスはトリガーされません。​「$Condition」には通常、リクエストをブロックしてはならない条件を評価するＰＨＰコードが含まれています。

バイパスがトリガーされると、「なぜブロックされましたか」フィールドに「$ReasonShort」が引用されます。

「$DefineOptions」は、オプショナル・キーと値のペアを含む配列です。​これは、リクエスト・インスタンスに固有の設定オプションを定義するために使用されます。​設定オプションは、バイパスがトリガーされたときに適用されます。

「$Bypass」は、バイパスがトリガされたときに真（true）を返し、そうでないときに偽（false）を返します。

このクロージャをモジュールで使用するには、最初に親スコープから継承することを忘れないでください：
```PHP
$Bypass = $CIDRAM['Bypass'];
```

##### 7.5.2 "$CIDRAM['DNS-Reverse']"

これは、ＩＰアドレスのホスト名を取得するために使用できます。​ホスト名をブロックするモジュールを作成する場合は、このクロージャーが便利です。

例：
```PHP
<?php
/** Inherit trigger closure (see functions.php). */
$Trigger = $CIDRAM['Trigger'];

/** Fetch hostname. */
if (empty($CIDRAM['Hostname'])) {
    $CIDRAM['Hostname'] = $CIDRAM['DNS-Reverse']($CIDRAM['BlockInfo']['IPAddr']);
}

/** Example signature. */
if ($CIDRAM['Hostname'] && $CIDRAM['Hostname'] !== $CIDRAM['BlockInfo']['IPAddr']) {
    $Trigger($CIDRAM['Hostname'] === 'www.foobar.tld', 'Foobar.tld', 'Hostname Foobar.tld is not allowed.');
}
```

#### 7.6 モジュール変数

モジュールは独自のスコープ内で実行され、モジュールで定義された変数は他のモジュールや親スクリプトにアクセスできません。​「$CIDRAM」配列に格納されている場合を除いて（この配列は保持されます；モジュールの実行が終了した後はすべてがフラッシュされます）。

あなたのモジュールに役立つ一般的な変数は次のとおりです：

変数 | 説明
----|----
`$CIDRAM['BlockInfo']['DateTime']` | 現在の日付と時刻。
`$CIDRAM['BlockInfo']['IPAddr']` | 現在のリクエストのＩＰアドレス。
`$CIDRAM['BlockInfo']['ScriptIdent']` | CIDRAMスクリプトのバージョン。
`$CIDRAM['BlockInfo']['Query']` | 現在のリクエストのクエリ。
`$CIDRAM['BlockInfo']['Referrer']` | 現在のリクエストのリファラー（存在する場合）。
`$CIDRAM['BlockInfo']['UA']` | 現在のリクエストのユーザー・エージェント（user agent）。
`$CIDRAM['BlockInfo']['UALC']` | 現在のリクエストの小文字でユーザー・エージェント（user agent）。
`$CIDRAM['BlockInfo']['ReasonMessage']` | 現在のリクエストがブロックされている場合、ユーザー/クライアントに表示されるメッセージです。
`$CIDRAM['BlockInfo']['SignatureCount']` | 現在のリクエストに対してトリガされたシグネチャの数。
`$CIDRAM['BlockInfo']['Signatures']` | 現在のリクエストに対してトリガーされたシグニチャーの参照情報。
`$CIDRAM['BlockInfo']['WhyReason']` | 現在のリクエストに対してトリガーされたシグニチャーの参照情報。

---


### 8. <a name="SECTION8"></a>適合性問題

次のパッケージと製品は、CIDRAMと互換性がないことが判明しています。
- __[Endurance Page Cache](https://github.com/CIDRAM/CIDRAM/issues/52)__

CIDRAMとの互換性を確保するために、以下のパッケージと製品用、モジュールが用意されています。
- __[BunnyCDN](https://github.com/CIDRAM/CIDRAM/issues/56)__

*参照：​[互換性チャート](https://maikuolan.github.io/Compatibility-Charts/)。*

---


### ９.<a name="SECTION9"></a>よくある質問（ＦＡＱ）

- [「シグネチャ」とは何ですか？](#WHAT_IS_A_SIGNATURE)
- [「ＣＩＤＲ」とは何ですか？](#WHAT_IS_A_CIDR)
- [「偽陽性」とは何ですか？](#WHAT_IS_A_FALSE_POSITIVE)
- [CIDRAMは国全体をブロックできますか？](#BLOCK_ENTIRE_COUNTRIES)
- [シグネチャはどれくらいの頻度でアップデイトされますか？](#SIGNATURE_UPDATE_FREQUENCY)
- [CIDRAMを使用しているときに問題が発生しましたが、​何をすべきかわかりません！​助けてください！](#ENCOUNTERED_PROBLEM_WHAT_TO_DO)
- [私はCIDRAMによってウェブサイトからブロックされています！​助けてください！](#BLOCKED_WHAT_TO_DO)
- [5.4.0より古いＰＨＰバージョンでCIDRAMを使用したいと思います；​手伝ってくれますか？](#MINIMUM_PHP_VERSION)
- [複数のドメインを保護するために１つのCIDRAMインストールを使用できますか？](#PROTECT_MULTIPLE_DOMAINS)
- [私はこれをインストールするか、​それが私のウェブサイト上で動作することを保証する時間を費やす、​にしたくない；​それできますか？​私はあなたを雇うことができますか？](#PAY_YOU_TO_DO_IT)
- [あなたまたはこのプロジェクトの任意の開発者は雇用可能ですか？](#HIRE_FOR_PRIVATE_WORK)
- [私は専門家の変更、​カスタム化、​等が必要です；​手伝ってくれますか？](#SPECIALIST_MODIFICATIONS)
- [私は開発者、​ウェブサイトデザイナー、​またはプログラマーです。​このプロジェクトに関連する作業を行うことはできますか？](#ACCEPT_OR_OFFER_WORK)
- [私はプロジェクトに貢献したい；​これはできますか？](#WANT_TO_CONTRIBUTE)
- [Cronを使って自動的にアップデートできますか？](#CRON_TO_UPDATE_AUTOMATICALLY)
- [「違反」とは何ですか？](#WHAT_ARE_INFRACTIONS)
- [CIDRAMはホスト名をブロックできますか？](#BLOCK_HOSTNAMES)
- [「default_dns」には何が使えますか？](#WHAT_CAN_I_USE_FOR_DEFAULT_DNS)
- [CIDRAMを使用してウェブサイト以外のもの（メールサーバー、ＦＴＰ、ＳＳＨ、ＩＲＣ、など）を保護することはできますか？](#PROTECT_OTHER_THINGS)
- [ＣＤＮやキャッシュ・サービスを使用するのと同時にCIDRAMを使用すると問題が発生しますか？](#CDN_CACHING_PROBLEMS)
- [CIDRAMは、私のウェブサイトをＤＤｏＳ攻撃から守りますか？](#DDOS_ATTACKS)
- [アップデート・ページでモジュールまたはシグネチャ・ファイルを有効または無効にすると、コンフィギュレーションに英数字でソートされます。​彼らのソート方法を変更することはできますか？](#CHANGE_COMPONENT_SORT_ORDER)

#### <a name="WHAT_IS_A_SIGNATURE"></a>「シグネチャ」とは何ですか？

CIDRAMの文脈では、​「シグネチャ」とは、​インジケータ/識別子として機能するデータである。​私たちはそれを使って、​探しているものを見つけます（通常はＩＰアドレスまたはＣＩＤＲです）。​しばしば、​それはCIDRAMのための何らかの命令を含む（応答する最善の方法、​等）。​CIDRAMの典型的なシグネチャは、​次のようになります。

「シグネチャ・ファイル」の場合：

`1.2.3.4/32 Deny Generic`

「モジュール」の場合：

```PHP
$Trigger(strpos($CIDRAM['BlockInfo']['UA'], 'Foobar') !== false, 'Foobar-UA', 'User agent "Foobar" not allowed.');
```

*注意：​「シグネチャ・ファイル」のシグネチャと、「モジュール」のシグネチャは、同じではありません。*

しばしば（しかし、​常にではない）、​シグネチャは一緒に束ねられて「シグネチャセクション」を形成します。​コメント、​マークアップ、​および関連するメタデータが付いていることがよくあります（これは、​追加の文脈およびさらなる指示を提供するために使用することができる）。

#### <a name="WHAT_IS_A_CIDR"></a>「ＣＩＤＲ」とは何ですか？

「ＣＩＤＲ」は「Classless Inter-Domain Routing」（クラスレス・ドメイン間・ルーティング）の略語です *「[１](https://ja.wikipedia.org/wiki/Classless_Inter-Domain_Routing)、​[２](http://whatismyipaddress.com/cidr)」*。​この略語は、​このパッケージの名前の一部、​「CIDRAM」、​として使用されます。​「CIDRAM」は「Classless Inter-Domain Routing Access Manager」（クラスレス・ドメイン間・ルーティング・アクセス・マネージャー）の略語です。

しかし、​CIDRAMの文脈では（例えば、​このドキュメント内、​CIDRAMに関する議論の中で、​CIDRAM言語データ内）、​「CIDR」が言及されるたびに、​私たちの意図する意味は、​CIDR表記を使って表現されたサブネットです。​これは、​意味を明確にするためです（サブネットは複数の方法で表現できるため）。​したがって、​CIDRAMは「サブネット・アクセス・マネージャ」と見なすことができます。

この説明は、​提供された文脈とともに、​あいまいさを解決するのに役立つはずです。

#### <a name="WHAT_IS_A_FALSE_POSITIVE"></a>「偽陽性」とは何ですか？

一般化された文脈で簡単に説明、​条件の状態をテストするときに、​結果を参照する目的で、​用語「偽陽性」（*または：偽陽性のエラー、​虚報；* 英語：*false positive*; *false positive error*; *false alarm*）の意味は、​結果は「陽性」のようです、​しかし結果は間違いです（即ち、​真の条件は「陽性/真」とみなされます、​しかしそれは本当に「陰性/偽」です）。​「偽陽性」は「泣く狼」に類似していると考えることができます（その状態は群の近くに狼がいるかどうかである、​真の条件は「偽/陰性」です、​群れの近くに狼がないからです、​しかし条件は「真/陽性」として報告されます、​羊飼いが「狼！​狼！​」を叫んだからです）、​または、​医療検査に類似、​患者が誤って診断されたとき。

いくつかの関連する用語は、​「真陽性」、​「真陰性」、​と「偽陰性」です。​これらの用語が示す意味：​「真陽性」の意味は、​テスト結果と真の条件が真です（即ち、​「陽性」です）。​「真陰性」の意味は、​テスト結果と真の条件が偽です（即ち、​「陰性」です）。​「真陽性」と「真陰性」は「正しい推論」とみなされます。​「偽陽性」の反対は「偽陰性」です。​「偽陰性」の意味は、​テスト結果が偽です（即ち、​「陰性」です）、​しかし、​真の条件が本当に真です（即ち、​「陽性」です）；​両方テスト結果と真の条件、​が「真/陽性」すべきであるはずです。

CIDRAMの文脈で、​これらの用語は、​CIDRAMのシグネチャとそれらがブロックするものを指します。​CIDRAMが誤ってＩＰアドレスをブロックすると（例えば、​不正確なシグネチャ、​時代遅れのシグネチャなどによる）、​我々はこのイベント「偽陽性」のを呼び出します。​CIDRAMがＩＰアドレスをブロックできなかった場合（例えば、​予期せぬ脅威、​シグネチャの欠落などによる）、​我々はこのイベント「不在検出」のを呼び出します（「偽陰性」のアナログです）。

これは、​以下の表に要約することができます。

&nbsp; | CIDRAMは、​ＩＰアドレスをブロック必要がありません | CIDRAMは、​ＩＰアドレスをブロック必要があります
---|---|---
CIDRAMは、​ＩＰアドレスをブロックしません | 真陰性（正しい推論） | 不在検出（それは「偽陰性」と同じです）
CIDRAMは、​ＩＰアドレスをブロックします | __偽陽性__ | 真陽性（正しい推論）

#### <a name="BLOCK_ENTIRE_COUNTRIES"></a>CIDRAMは国全体をブロックできますか？

はい。​これを達成する最も簡単な方法は、​Macmathanが提供する国オプショナルブロックリストのいくつかをインストールします。​これはフロントエンドのアップデート・ページから直接行うことができます。​あるいは、​フロントエンドを無効のままにしたい場合は、​**[国オプショナルブロックリストのダウンロードページ](https://macmathan.info/blocklists)** からダウンロードできます。​ダウンロード後、​それらをvaultにアップロードする, 関連する設定ディレクティブで名前を挙げてください。

#### <a name="SIGNATURE_UPDATE_FREQUENCY"></a>シグネチャはどれくらいの頻度でアップデイトされますか？

アップデイト頻度は、​シグネチャファイルによって異なります。​CIDRAMのシグネチャファイルのすべてのメンテナーが頻繁にアップデイトを試みる、​しかし、​私たちの皆様には、​他にもさまざまなコミットメントがあり、​私たちはプロジェクトの外で生活しており、​と誰も財政的に補償されていない、​したがって、​正確なアップデイトスケジュールは保証されません。​一般に、​十分な時間があればシグネチャがアップデイトされます。​メンテナーは必要性と範囲間の変化の頻度に基づいて優先順位をつけようとする。​あなたが何かを提供できるのであれば、​援助は常に高く評価されます。

#### <a name="ENCOUNTERED_PROBLEM_WHAT_TO_DO"></a>CIDRAMを使用しているときに問題が発生しましたが、​何をすべきかわかりません！​助けてください！

- あなたは最新のソフトウェアバージョンを使用していますか？​あなたは最新のシグネチャファイルバージョンを使用していますか？​そうでない場合は、​まずすべてをアップデイトしてください。​問題が解決しないかどうかをチェックしてください。​それが続く場合は、​読んでください。
- あなたはドキュメンテーションをチェックしましたか？​もしそうでなければ、​そうしてください。​ドキュメンテーションを使用して問題を解決できない場合は、​引き続き読んでください。
- **[イシュー・ページ](https://github.com/CIDRAM/CIDRAM/issues)** をチェックしましたか？​問題が以前に言及されているかどうかをチェックしてください。​提案、​アイデア、​ソリューションが提供されたかどうかをチェックしてください。
- 問題が解決しない場合は、​教えてください。​イシュー・ページに関する新しいディスカッションを作成する。

#### <a name="BLOCKED_WHAT_TO_DO"></a>私はCIDRAMによってウェブサイトからブロックされています！​助けてください！

CIDRAMは、​ウェブサイト所有者が望ましくないトラフィックをブロックする手段を提供します、​しかし、​ウェブサイト所有者は、​その使用方法を決定する必要があります。​シグネチャファイルに誤検出がある場合、​訂正を行うことができる、​しかし、​特定のウェブサイトからブロック解除されていることに関して、​あなたはウェブサイト所有者に連絡する必要があります。​修正が行われると、​更新が必要になります。​それ以外の場合は、​問題を解決するのは彼らの責任です。​カスタム化と個人的な選択は、​私たちのコントロールを完全に超えています。

#### <a name="MINIMUM_PHP_VERSION"></a>5.4.0より古いＰＨＰバージョンでCIDRAMを使用したいと思います；​手伝ってくれますか？

いいえ。​PHP 5.4.0は2014年に公式EoL（「End of Life」/人生の終わり）に達しました。​長期的なセキュリティサポートは2015年に終了しました。​現在、​それは2017であり、​PHP 7.1.0はすでに利用可能です。​現在、​PHP 5.4.0およびすべてのより新しいＰＨＰバージョンでCIDRAMを使用するためのサポートが提供されています。​より古いＰＨＰバージョンのサポートは提供されていません。

*参照：​[互換性チャート](https://maikuolan.github.io/Compatibility-Charts/)。*

#### <a name="PROTECT_MULTIPLE_DOMAINS"></a>複数のドメインを保護するために１つのCIDRAMインストールを使用できますか？

はい。​CIDRAMのインストールは特定のドメインに限定されていません、​したがって、​複数のドメインを保護するために使用できます。​一般的に、​１つのドメインのみを保護するインストール、​私たちは「単一ドメイン・インストール」と呼んでいますで、​複数のドメイン/サブドメインを保護するインストール、​私たちは「マルチドメイン・インストール」と呼んでいます。​マルチドメインインストールを使用している場合で、​異なるドメインに異なるシグネチャ・ファイルセットを使用する必要がある場合や、​異なるドメインにCIDRAMを異なる設定する必要があります、​これを行うことができます。​コンフィグレーション・ファイルをロードした後（`config.ini`）、​CIDRAMは、​リクエストされたドメインの「コンフィグレーション・オーバーライド・ファイル」の存在をチェックします (`xn--48jua8kwd4hof5er493ch97b.tld.config.ini`)、​そして見つかった場合、​コンフィグレーション・オーバーライド・ファイルによって定義されたコンフィグレーション値は、​コンフィグレーション・ファイルによって定義されたコンフィグレーション値ではなく、​実行インスタンスに使用されます。​コンフィグレーション・オーバーライド・ファイルは、​コンフィグレーション・ファイルと同じです。​お客様の裁量で、​CIDRAMで利用可能なすべての設定指示句の全体または必要なサブセクションを含めることができます。​コンフィグレーション・オーバーライド・ファイルは彼らが意図しているドメインに従って命名されます （そう、​例えば、​ドメイン`http://www.some-domain.tld/`にコンフィグレーション・オーバーライド・ファイルが必要な場合は、​コンフィグレーション・オーバーライド・ファイルの名前は`some-domain.tld.config.ini`にする必要があります。​通常の設定ファイルと同じ場所に保存する必要があります）。​ドメイン名は `HTTP_HOST` から来ます。​"www"は無視されます。

#### <a name="PAY_YOU_TO_DO_IT"></a>私はこれをインストールするか、​それが私のウェブサイト上で動作することを保証する時間を費やす、​にしたくない；​それできますか？​私はあなたを雇うことができますか？

多分。​これは、​ケースバイケースで検討されています。​あなたのニーズと提供できるものを教えてください。​私たちが助けることができるかどうかを教えてあげます。

#### <a name="HIRE_FOR_PRIVATE_WORK"></a>あなたまたはこのプロジェクトの任意の開発者は雇用可能ですか？

*上記を参照。*

#### <a name="SPECIALIST_MODIFICATIONS"></a>私は専門家の変更、​カスタム化、​等が必要です；​手伝ってくれますか？

*上記を参照。*

#### <a name="ACCEPT_OR_OFFER_WORK"></a>私は開発者、​ウェブサイトデザイナー、​またはプログラマーです。​このプロジェクトに関連する作業を行うことはできますか？

はい。​私たちのライセンスはこれを禁止していません。

#### <a name="WANT_TO_CONTRIBUTE"></a>私はプロジェクトに貢献したい；​これはできますか？

はい。​プロジェクトへの貢献は大歓迎です。​詳細については、​「CONTRIBUTING.md」を参照してください。

#### <a name="CRON_TO_UPDATE_AUTOMATICALLY"></a>Cronを使って自動的にアップデートできますか？

はい。​外部スクリプトを介してアップデート・ページと対話するためのＡＰＩがフロントエンドに組み込まれています。​別のスクリプト、「[Cronable](https://github.com/Maikuolan/Cronable)」、が利用可能です。​これは「cron manager （クロン・マネージャー）」や「cron scheduler （クロン・スケジューラ）」がこれと他のサポートされているパッケージを自動的に更新するために使うことができます（このスクリプトは独自のドキュメントを提供しています）。

#### <a name="WHAT_ARE_INFRACTIONS"></a>「違反」とは何ですか？

「違反」は、特定のシグネチャ・ファイルによってまだブロックされていないＩＰが将来のリクエストに対してブロックされる時期を決定します。​これらはＩＰトラッキングに密接に関連しています。​いくつかの機能とモジュールが存在し、元のIP以外の理由でリクエストをブロックすることができます​（例えば、スパムロボッ「spambots」トやハックツール「hacktools」に対応するユーザー・エージェント「user agents」の存在、危険な照会、偽装されたＤＮＳなどの理由）。​これが起こると、「違反」が起こる可能性があります。​これらは、特定のシグネチャ・ファイルによってまだブロックされていない不要なリクエストに対応するＩＰアドレスを識別する方法を提供します。​違反は通常、ＩＰがブロックされた回数と1対1に対応しますが、必ずしもそうではありません（重大なケースでは、より大きな違反価値があるかもしれない、また、「track_mode」が偽である場合、シグネチャ・ファイルのみによってトリガされたブロック・イベントに対して違反は発生しません）。

#### <a name="BLOCK_HOSTNAMES"></a>CIDRAMはホスト名をブロックできますか？

はい。​これを行うには、カスタム・モジュール・ファイルを作成する必要があります。 *参照する：​[基本原則 （モジュールの場合）](#MODULE_BASICS)*.

#### <a name="WHAT_CAN_I_USE_FOR_DEFAULT_DNS"></a>「default_dns」には何が使えますか？

あなたが提案を探しているならば、「[public-dns.info](https://public-dns.info/)」と「[OpenNIC](https://servers.opennic.org/)」は既知の公開ＤＮＳサーバーの広範なリストを提供します。​または、次の表を参照してください：

ＩＰ | オペレーター
---|---
`1.1.1.1` | [Cloudflare](https://www.cloudflare.com/learning/dns/what-is-1.1.1.1/)
`4.2.2.1`<br />`4.2.2.2`<br />`209.244.0.3`<br />`209.244.0.4` | [Level3](https://www.level3.com/en/)
`8.8.4.4`<br />`8.8.8.8`<br />`2001:4860:4860::8844`<br />`2001:4860:4860::8888` | [Google Public DNS](https://developers.google.com/speed/public-dns/)
`9.9.9.9`<br />`149.112.112.112` | [Quad9 DNS](https://www.quad9.net/)
`84.200.69.80`<br />`84.200.70.40`<br />`2001:1608:10:25::1c04:b12f`<br />`2001:1608:10:25::9249:d69b` | [DNS.WATCH](https://dns.watch/index)
`208.67.220.220`<br />`208.67.222.220`<br />`208.67.222.222` | [OpenDNS Home](https://www.opendns.com/)
`77.88.8.1`<br />`77.88.8.8`<br />`2a02:6b8::feed:0ff`<br />`2a02:6b8:0:1::feed:0ff` | [Yandex.DNS](https://dns.yandex.com/advanced/)
`8.20.247.20`<br />`8.26.56.26` | [Comodo Secure DNS](https://www.comodo.com/secure-dns/)
`216.146.35.35`<br />`216.146.36.36` | [Dyn](https://help.dyn.com/internet-guide-setup/)
`64.6.64.6`<br />`64.6.65.6` | [Verisign Public DNS](https://www.verisign.com/en_US/security-services/public-dns/index.xhtml)
`37.235.1.174`<br />`37.235.1.177` | [FreeDNS](https://freedns.zone/en/)
`156.154.70.1`<br />`156.154.71.1`<br />`2610:a1:1018::1`<br />`2610:a1:1019::1` | [Neustar Security](https://www.security.neustar/dns-services/free-recursive-dns-service)
`45.32.36.36`<br />`45.77.165.194`<br />`179.43.139.226` | [Fourth Estate](https://dns.fourthestate.co/)
`74.82.42.42` | [Hurricane Electric](https://dns.he.net/)
`195.46.39.39`<br />`195.46.39.40` | [SafeDNS](https://www.safedns.com/en/features/)
`81.218.119.11`<br />`209.88.198.133` | [GreenTeam Internet](http://www.greentm.co.uk/)
`89.233.43.71`<br />`91.239.100.100 `<br />`2001:67c:28a4::`<br />`2a01:3a0:53:53::` | [UncensoredDNS](https://blog.uncensoreddns.org/)
`208.76.50.50`<br />`208.76.51.51` | [SmartViper](http://www.markosweb.com/free-dns/)

*注意：​私は、ＤＮＳサービス（リストされた、リストされていない、いずれの場合）のプライバシーの実践、セキュリティ、有効性、または信頼性に関して、いかなる請求または保証もしません。​決定を下す際には、あなた自身の研究をしてください。*

#### <a name="PROTECT_OTHER_THINGS"></a>CIDRAMを使用してウェブサイト以外のもの（メールサーバー、ＦＴＰ、ＳＳＨ、ＩＲＣ、など）を保護することはできますか？

それは（法的に）可能ですが、それは（実質的かつ技術的に）良い考えではありません。​CIDRAMライセンスは、どの技術がCIDRAMを実装するかを制限しません。​しかし、CIDRAMはＷＡＦ「ウェブアプリケーションファイアウォール」であり、常にウェブサイトを保護するためのものです。​他のテクノロジを念頭に置いて設計されたものではないため、他のテクノロジに対して効果的であるか、または信頼性の高い保護を提供する可能性は低いです。​実装が難しくなる可能性があり、偽陽性や不在検出のリスクは非常に高いです。

#### <a name="CDN_CACHING_PROBLEMS"></a>ＣＤＮやキャッシュ・サービスを使用するのと同時にCIDRAMを使用すると問題が発生しますか？

多分。​これは、サービスとそれをどのように使用しているかによって異なります。​一般的に、静的アセットのみをキャッシュする場合、問題はありません（静的アセットは、時間の経過とともに変化しないものを意味します；例えば、画像、CSS、など）。​しかし、要求に応じて動的に生成されるデータをキャッシュするときや、POST要求の結果をキャッシュしているときに問題が生じることがあります（これはあなたのウェブサイトとその環境を静的にし、CIDRAMは静的な環境で意味のある利益をもたらすことはまずありません）。​使用しているＣＤＮまたはキャッシュ・サービスに基づいて、CIDRAMに固有のコンフィグレーション要件が存在する場合があります（ニーズに合わせてCIDRAMが正しく設定されていることを確認してください）。​コンフィグレーションが正しくないと、重大な問題が発生することがあります。

#### <a name="DDOS_ATTACKS"></a>CIDRAMは、私のウェブサイトをＤＤｏＳ攻撃から守りますか？

短い答え：いいえ。

より詳細な答え：​CIDRAMは、望ましくないトラフィックがあなたのウェブサイトに及ぼす影響を軽減するのに役立ちます（ウェブサイトの帯域幅コストを削減します）、​望ましくないトラフィックがあなたのハードウェアに及ぼす影響を軽減するのに役立ちます（たとえば、リクエストを処理して提供するサーバーの能力）、​望ましくないトラフィックに関連するその他のさまざまな潜在的な悪影響を軽減するのに役立ちます。​しかし、この質問を理解するためには、２つの重要なことを覚えておく必要があります。 １. CIDRAMはＰＨＰパッケージであるため、ＰＨＰがインストールされているマシンで動作します。​このため、CIDRAMは、サーバーがすでに要求を受信した後にのみ要求を表示およびブロックできます。 ２. 効果的なＤＤｏＳ軽減は、ＤＤｏＳ攻撃の対象となるサーバーに到達する前に要求をフィルタリングする必要があります。​理想的には、DDoS攻撃は、ターゲット・サーバーに到達する前に、攻撃に関連するトラフィックをドロップまたは再ルーティングできるソリューションによって検出および緩和する必要があります。

これは、専用のオンプレミス・ハードウェア・ソリューション、専用のＤＤｏＳ軽減サービスなどのクラウド・ベースのソリューション、ＤＤｏＳ対応ネットワークを介してドメインのＤＮＳをルーティング、クラウド・ベースのフィルタリング、またはそれらのいくつかの組み合わせを使用して実施することができる。​いずれにしても、この主題はちょうど単なる段落または２つで完全に説明するのは少し複雑すぎる。​これがあなたが追求したい科目であれば、さらなる研究をすることをお勧めします。​ＤＤｏＳ攻撃の真の性質が適切に理解されている場合、この回答はより理にかなっています。

#### <a name="CHANGE_COMPONENT_SORT_ORDER"></a>アップデート・ページでモジュールまたはシグネチャ・ファイルを有効または無効にすると、コンフィギュレーションに英数字でソートされます。​彼らのソート方法を変更することはできますか？

はい。​特定の順序で実行するファイルが必要な場合は、コンフィギュレーション・ディレクティブの名前の前に任意のデータを追加できます（このデータと名前を区切るためにコロンを使用します）。​その後、アップデート・ページでファイルを再度並べ替えると、この追加された任意のデータがソート順に影響します。​これにより、それらの名前を変更せずに、必要な順序で実行されます。

たとえば、次のようにファイルをコンフィギュレーション・ディレクティブがあるとします：

`file1.php,file2.php,file3.php,file4.php,file5.php`

`file3.php`を最初に実行したければ、ファイル名の前に`aaa:`のようなものを追加することができます：

`file1.php,file2.php,aaa:file3.php,file4.php,file5.php`

次に、新しいファイル`file6.php`が有効になっている場合、アップデート・ページがそれらをすべて並べ替えると、次のようになります：

`aaa:file3.php,file1.php,file2.php,file4.php,file5.php,file6.php`

ファイルが非アクティブになったときと同じ状況です。​逆に、ファイルを最後に実行したい場合は、ファイルの名前の前に`zzz:`のようなものを追加することができます。​いずれの場合でも、問題のファイルの名前を変更する必要はありません。

---


### １１.<a name="SECTION11"></a>法律情報

#### 11.0 セクション・プリアンブル

ドキュメンテーションのこのセクションは、パッケージの使用と実装に関する法律上の考慮事項を説明し、基本的な関連情報を提供することを目的としています。​これは、操作している国に存在する可能性のある法的要件の遵守を確実にする手段として、一部のユーザーにとって重要な場合があります。​一部のユーザーは、この情報に従ってウェブサイトポリシーを調整する必要があります。

まず、私（パッケージ作成者）は弁護士ではない、有資格の法律専門家でもないことを認識してください。​したがって、私は法律上のアドバイスを提供する法的資格はありません。​また、場合によっては、正確な法的要件は、国や地域によって異なる場合があります。​また、これらが競合することがあります​（例えば：[プライバシーの権利](https://ja.wikipedia.org/wiki/%E3%83%97%E3%83%A9%E3%82%A4%E3%83%90%E3%82%B7%E3%83%BC)を享受する国と[忘れられる権利](https://ja.wikipedia.org/wiki/%E5%BF%98%E3%82%8C%E3%82%89%E3%82%8C%E3%82%8B%E6%A8%A9%E5%88%A9)の場合には、拡張されたデータ保持を望む国と比較して）。​また、パッケージへのアクセスが特定の国や管轄区域に限定されているわけではないので、パッケージのユーザーベースは地理的に多様である可能性が高いと考えてください。​これらの点を考慮して、私はすべての点で、すべてのユーザーにとって「法的に準拠する」であることが何を意味するかを述べる立場にはいません。​ただし、ここに記載されている情報が、パッケージの文脈で法的に遵守するために必要な作業を自分で決定するのに役立つことを願っています。​疑義が存続する場合、または法的な観点から追加の助けと助言が必要な場合は、有資格の法律専門家に相談することをおすすめします。

#### 11.1 責任

パッケージ・ライセンスに記載されている通り、パッケージは無保証で提供されます。​これには、すべての責任範囲が含まれます（ただしこれに限定されません）。​あなたの便宜のためにパッケージが提供されています。​それが有用であり、それがあなたのためにいくつかの利益をもたらすことが期待されます。​しかし、あなたがパッケージを使用するか実装するかは、あなた自身の選択です。​あなたはパッケージを使用するよう強制されません。​しかし、あなたが決めるところでは、あなたはその決定に責任があります。​あなたの意思決定の結果について、私と他のパッケージ寄稿者は、直接的、間接的、暗示的、またはその他の方法にかかわらず、責任を負いません。

#### 11.2 第三者

その正確なコンフィギュレーションと実装に応じて、パッケージは場合によっては第三者と通信し、情報を共有することがあります。​この情報は、いくつかの国において、状況によっては、「[個人を特定できる情報](https://ja.wikipedia.org/wiki/%E5%80%8B%E4%BA%BA%E6%83%85%E5%A0%B1)」（ＰＩＩ）と定義することができます。

これらの第三者がこの情報をどのように使用するかは、これらの第三者によって定められたさまざまなポリシーの対象となります。​このドキュメントの範囲外です。​ただし、このような場合は、これらの第三者との情報の共有を無効にすることができます。​そのような場合は、有効にすることを選択した場合、これらの第三者によるＰＩＩのプライバシー、セキュリティ、および使用に関する懸念事項を調査することは、おあなたの責任です。​ご不明な点がある場合、またはＰＩＩに関してこれらの第三者の行為に不満がある場合は、これらの第三者との情報の共有をすべて無効にすることが最善の方法です。

透明性のために、共有される情報のタイプと、誰と、以下に記載されています。

##### 11.2.0 ホスト名検索

If you use any features or modules intended to work with hostnames (such as the "bad hosts blocker module", "tor project exit nodes block module", or "search engine verification", for example), CIDRAM needs to be able to obtain the hostname of inbound requests somehow. Typically, it does this by requesting the hostname of the IP address of inbound requests from a DNS server, or by requesting the information through functionality provided by the system where CIDRAM is installed (this is typically referred to as a "hostname lookup"). The DNS servers defined by default belong to the Google DNS service (but this can be easily changed via configuration). The exact services communicated with is configurable, and depends on how you configure the package. In the case of using functionality provided by the system where CIDRAM is installed, you'll need to contact your system administrator to determine which routes hostname lookups use. Hostname lookups can be prevented in CIDRAM by avoiding the affected modules or by modifying the package configuration in accordance with your needs.

*関連するコンフィギュレーション・ディレクティブ：*
- `general` -> `default_dns`
- `general` -> `search_engine_verification`
- `general` -> `social_media_verification`
- `general` -> `force_hostname_lookup`
- `general` -> `allow_gethostbyaddr_lookup`

##### 11.2.1 ウェブフォンツ

CIDRAMのフロントエンドと「アクセス拒否」ページの標準「ＵＩ」（ユーザー・インターフェイス）と同様に、一部のカスタム・テーマでは、美的な理由から「webfonts」（ウェブフォンツ）が使用されることがあります。​「Webfonts」（ウェブフォンツ）はデフォルトで無効になっていますが、有効にすると、ユーザーのブラウザと「webfont service」（ウェブフォント・サービス）間の直接通信が行われます。​これは、ユーザのＩＰアドレス、ユーザ・エージェント、オペレーティング・システム、および要求に利用可能な他の詳細などの情報を伝達することを潜在的に含むことがある。​これらのウェブフォンツのほとんどは「[Google Fonts](https://fonts.google.com/)」サービスによってホストされています。

*関連するコンフィギュレーション・ディレクティブ：*
- `general` -> `disable_webfonts`

##### 11.2.2 検索エンジンの検証 （サーチ・エンジン・ベリフィケーション）

When search engine verification is enabled, CIDRAM attempts to perform "forward DNS lookups" to verify the authenticity of requests that claim to originate from search engines. To do this, it uses the Google DNS service to attempt to resolve IP addresses from the hostnames of these inbound requests (in this process, the hostnames of these inbound requests is shared with the service).

*関連するコンフィギュレーション・ディレクティブ：*
- `general` -> `search_engine_verification`

##### 11.2.3 GOOGLE reCAPTCHA

CIDRAM optionally supports Google reCAPTCHA, providing a means for users to bypass the "Access Denied" page by completing a reCAPTCHA instance (more information about this feature is described earlier in the documentation, most notably in the configuration section). Google reCAPTCHA requires API keys in order to be work correctly, and is thereby disabled by default. It can be enabled by defining the required API keys in the package configuration. When enabled, direct communication between the user's browser and the reCAPTCHA service occurs. This may potentially involve communicating information such as the user's IP address, user agent, operating system, and other details available to the request. The user's IP address may also be shared in communication between CIDRAM and the reCAPTCHA service when verifying the validity of a reCAPTCHA instance and verifying whether it was completed successfully.

*関連するコンフィギュレーション・ディレクティブ：​すべての「recaptcha」コンフィギュレーション・カテゴリの下にリストされているもの。*

##### 11.2.4 STOP FORUM SPAM （ストップ・フォーラム・スパム）

[Stop Forum Spam](https://www.stopforumspam.com/) is a fantastic, freely available service that can help to protect forums, blogs, and websites from spammers. It does this by providing a database of known spammers, and an API that can be leveraged to check whether an IP address, username, or email address is listed on its database.

CIDRAM provides an optional module that leverages this API to check whether the IP address of inbound requests belongs to a suspected spammer. The module is not installed by default, but if you choose to install it, user IP addresses may be shared with the Stop Forum Spam API in accordance with the intended purpose of the module. When the module is installed, CIDRAM communicates with this API whenever an inbound request requests a resource that CIDRAM recognises as a type of resource frequently targeted by spammers (such as login pages, registration pages, email verification pages, comment forms, etc).

#### 11.3 ロギング

Logging is an important part of CIDRAM for a number of reasons. It may be difficult to diagnose and resolve false positives when the block events that cause them aren't logged. Without logging block events, it may be difficult to ascertain exactly how performant CIDRAM is in any particular context, and it may be difficult to determine where its shortfalls may be, and what changes may be required to its configuration or signatures accordingly, in order for it to continue functioning as intended. Regardless, logging mightn't be desirable for all users, and remains entirely optional. In CIDRAM, logging is disabled by default. To enable it, CIDRAM must be configured accordingly.

Additionally, whether logging is legally permissible, and to the extent that it is legally permissible (e.g., the types of information that may logged, for how long, and under what circumstances), may vary, depending on jurisdiction and on the context where CIDRAM is implemented (e.g., whether you're operating as an individual, as a corporate entity, and whether on a commercial or non-commercial basis). It may therefore be useful for you to read through this section carefully.

There are multiple types of logging that CIDRAM can perform. Different types of logging involves different types of information, for different reasons.

##### 11.3.0 BLOCK EVENTS

The primary type of logging that CIDRAM can perform relates to "block events". This type of logging relates to when CIDRAM blocks a request, and can be provided in three different formats:
- Human readable logfiles.
- Apache-style logfiles.
- Serialised logfiles.

A block event, logged to a human readable logfile, typically looks something like this (as an example):

```
ID: 1234
Script Version: CIDRAM v1.6.0
Date/Time: Day, dd Mon 20xx hh:ii:ss +0000
IP Address: x.x.x.x
Hostname: dns.hostname.tld
Signatures Count: 1
Signatures Reference: x.x.x.x/xx
Why Blocked: Cloud service ("Network Name", Lxx:Fx, [XX])!
User Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.181 Safari/537.36
Reconstructed URI: http://your-site.tld/index.php
reCAPTCHA State: Enabled.
```

That same block event, logged to an Apache-style logfile, would look something like this:

```
x.x.x.x - - [Day, dd Mon 20xx hh:ii:ss +0000] "GET /index.php HTTP/1.1" 200 xxxx "-" "Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.181 Safari/537.36"
```

A logged block event typically includes the following information:
- An ID number referencing the block event.
- The version of CIDRAM currently in use.
- The date and time that the block event occurred.
- The IP address of the blocked request.
- The hostname of the IP address of the blocked request (when available).
- The number of signatures triggered by the request.
- References to the signatures triggered.
- References to the reasons for the block event and some basic, related debug information.
- The user agent of the blocked request (i.e., how the requesting entity identified itself to the request).
- A reconstruction of the identifier for the resource originally requested.
- The reCAPTCHA state for the current request (when relevant).

The configuration directives responsible for this type of logging, and for each of the three formats available, are:
- `general` -> `logfile`
- `general` -> `logfileApache`
- `general` -> `logfileSerialized`

When these directives are left empty, this type of logging will remain disabled.

##### 11.3.1 reCAPTCHA LOGGING

This type of logging relates specifically to reCAPTCHA instances, and occurs only when a user attempts to complete a reCAPTCHA instance.

A reCAPTCHA log entry contains the IP address of the user attempting to complete a reCAPTCHA instance, the date and time that the attempt occurred, and the reCAPTCHA state. A reCAPTCHA log entry typically looks something like this (as an example):

```
IP Address: x.x.x.x - Date/Time: Day, dd Mon 20xx hh:ii:ss +0000 - reCAPTCHA State: Passed!
```

The configuration directive responsible for reCAPTCHA logging is:
- `recaptcha` -> `logfile`

##### 11.3.2 FRONT-END LOGGING

This type of logging relates front-end login attempts, and occurs only when a user attempts to log into the front-end (assuming front-end access is enabled).

A front-end log entry contains the IP address of the user attempting to log in, the date and time that the attempt occurred, and the results of the attempt (successfully logged in, or failed to log in). A front-end log entry typically looks something like this (as an example):

```
x.x.x.x - Day, dd Mon 20xx hh:ii:ss +0000 - "admin" - Logged in.
```

The configuration directive responsible for front-end logging is:
- `general` -> `FrontEndLog`

##### 11.3.3 LOG ROTATION

You may want to purge logs after a period of time, or may be required to do so by law (i.e., the amount of time that it's legally permissible for you to retain logs may be limited by law). You can achieve this by including date/time markers in the names of your logfiles as per specified by your package configuration (e.g., `{yyyy}-{mm}-{dd}.log`), and then enabling log rotation (log rotation allows you to perform some action on logfiles when specified limits are exceeded).

For example: If I was legally required to delete logs after 30 days, I could specify `{dd}.log` in the names of my logfiles (`{dd}` represents days), set the value of `log_rotation_limit` to 30, and set the value of `log_rotation_action` to `Delete`.

Conversely, if you're required to retain logs for an extended period of time, you could either not use log rotation at all, or you could set the value of `log_rotation_action` to `Archive`, to compress logfiles, thereby reducing the total amount of disk space that they occupy.

*関連するコンフィギュレーション・ディレクティブ：*
- `general` -> `log_rotation_limit`
- `general` -> `log_rotation_action`

##### 11.3.4 LOG TRUNCATION

It's also possible to truncate individual logfiles when they exceed a certain size, if this is something you might need or want to do.

*関連するコンフィギュレーション・ディレクティブ：*
- `general` -> `truncate`

##### 11.3.5 ＩＰアドレス・スドニマイゼーション

まず、あなたが用語に精通していない場合：​「スドニマイゼーション」（pseudonymisation）とは、補足情報なしで特定のデータ対象に特定できないような個人データの処理を指します​（ただし、そのような補足情報は、個人データが自然人に特定されないことを保証するために、個別に維持され、技術的および組織的措置を受けるものとします）。

次のリソースは詳細情報を提供します。
- [[trust-hub.com] What is pseudonymisation?](https://www.trust-hub.com/news/what-is-pseudonymisation/)
- [[Wikipedia] Pseudonymization](https://en.wikipedia.org/wiki/Pseudonymization)

In some circumstances, you may be legally required to anonymise or pseudonymise any PII collected, processed, or stored. Although this concept has existed for quite some time now, GDPR/DSGVO notably mentions, and specifically encourages "pseudonymisation".

CIDRAM is able to pseudonymise IP addresses when logging them, if this is something you might need or want to do. When CIDRAM pseudonymises IP addresses, when logged, the final octet of IPv4 addresses, and everything after the second part of IPv6 addresses is represented by an "x" (effectively rounding IPv4 addresses to the initial address of the 24th subnet they factor into, and IPv6 addresses to the initial address of the 32nd subnet they factor into).

*Note: CIDRAM's IP address pseudonymisation process doesn't affect CIDRAM's IP tracking feature. If this is a problem for you, it may be best to disable IP tracking entirely. This can be achieved by setting `track_mode` to `false` and by avoiding any modules.*

*関連するコンフィギュレーション・ディレクティブ：*
- `signatures` -> `track_mode`
- `legal` -> `pseudonymise_ip_addresses`

##### 11.3.6 OMITTING LOG INFORMATION

If you want to take it a step further by preventing specific types of information from being logged entirely, this is also possible to do. CIDRAM provides configuration directives to control whether IP addresses, hostnames, and user agents are included in logs. By default, all three of these data points are included in logs when available. Setting any of these configuration directives to `true` will omit the corresponding information from logs.

*Note: There's no reason to pseudonymise IP addresses when omitting them from logs entirely.*

*関連するコンフィギュレーション・ディレクティブ：*
- `legal` -> `omit_ip`
- `legal` -> `omit_hostname`
- `legal` -> `omit_ua`

##### 11.3.7 統計 （スタティスティックス）

CIDRAMは、オプションで、特定の時間以降に発生したブロック・イベントまたはreCAPTCHAインスタンスの総数などの統計を追跡できます。​この機能はデフォルトで無効になっていますが、パッケージ・コンフィギュレーションで有効にすることができます。​この機能は、発生したイベントの総数のみを追跡します。​特定のイベントに関する情報は含まれていませんので、ＰＩＩと見なされるべきではありません。

*関連するコンフィギュレーション・ディレクティブ：*
- `general` -> `statistics`

##### 11.3.8 暗号化 （エンクリプション）

CIDRAMは、キャッシュまたはログ情報を[暗号化](https://ja.wikipedia.org/wiki/%E6%9A%97%E5%8F%B7)しません。​キャッシュとログの暗号化は、将来導入される可能性がありますが、現在のところ具体的な計画はありません。​権限のない第三者によるＰＩＩへのアクセスについて（例えば、キャッシュ、ログ）：​CIDRAMは、一般にアクセス可能な場所にはインストールしないことをお勧めします（例えば、ほとんどのウェブサーバーで使用できる標準の`public_html`ディレクトリの外にCIDRAMをインストールする）、​そして適切に制限された権限が強制されるようにする（特に、「vault」ディレクトリ）。​懸念が残っている場合は、CIDRAMを設定して、この情報が収集または記録されないようにすることができます​（例えば、ロギングを無効にするなど）。

#### 11.4 COOKIES （クッキー）

CIDRAMは、コードベースの2つのポイントで[Cookie](https://ja.wikipedia.org/wiki/HTTP_cookie)を設定します。 １.ユーザーがreCAPTCHAインスタンスを正常に完了すると（これは、`lockuser`が`true`に設定されていると仮定します）、CIDRAMは、ユーザーがすでにreCAPTCHAインスタンスを完了しているという後続の要求を覚えておくために、Cookieを設定します。​この方法では、後続のリクエストでreCAPTCHAインスタンスを完了するようユーザーに継続的に要求する必要はありません。 ２.ユーザがフロントエンドに正常にログインすると、CIDRAMは後続のリクエストのためにユーザを覚えておくためにCookieを設定します（すなわち、Cookieはユーザをログインセッションに認証するために使用されます）。

いずれの場合も、Cookieに関する警告が目立つように表示され（該当する場合）、Cookieが関連するアクションに関与する場合にCookieが設定されることをユーザーに警告します。​Cookieは、コードベースの他のどの場所にも設定されていません。

*注意：CIDRAMのreCAPTCHA「invisible」API実装は、一部の地域ではCookie法と互換性がない可能性があります。​これらの法律の対象となるウェブサイトでは、「invisible」APIを回避する必要があります。​代わりに「V2」APIを使用するか、完全にreCAPTCHAを無効にすることをお勧めします。*

*関連するコンフィギュレーション・ディレクティブ：*
- `general` -> `disable_frontend`
- `recaptcha` -> `lockuser`
- `recaptcha` -> `api`

#### 11.5 マーケティングやアドバタイジング

CIDRAMは、マーケティングやアドバタイジング目的で情報を収集または処理しません。​収集または記録された情報を販売したり、利益を得たりすることはありません。​CIDRAMは商業的企業ではなく、商業的利益には関係しないので、これらのことは意味をなさないでしょう。​これは、プロジェクトの開始以来のケースであり、今日も引き続き行われています。​さらに、これらのことを行うことは、プロジェクトの精神と目的に沿ったものではなく、私がプロジェクトを維持し続ける限り、決して起こらないでしょう。

#### 11.6 プライバシー・ポリシー

場合によっては、ウェブサイトのすべてのページとセクションにプライバシー・ポリシーへのリンクを明確に表示することが法的に要求されることがあります。​これは、ユーザーが正確なプライバシー・プラクティス、収集するＰＩＩのタイプ、および使用する方法を十分に知らされていることを保証する手段として重要です。​このようなリンクをCIDRAMの「アクセス拒否」ページに含めるには、プライバシー・ポリシーのＵＲＬを指定するためのコンフィギュレーション・ディレクティブが用意されています。

*注意：​プライバシー・ポリシー・ページは、CIDRAMの保護の背後に置かないことを強くお勧めします。​CIDRAMがプライバシー・ポリシー・ページを保護し、CIDRAMによってブロックされたユーザーがプライバシー・ポリシーへのリンクをクリックすると、ユーザーは再びブロックされ、プライバシー・ポリシーが表示されなくなります。​理想的には、ＨＴＴＰページやプレーン・テキスト・ファイルなど、プライバシー・ポリシーの静的コピーにリンクする。*

*関連するコンフィギュレーション・ディレクティブ：*
- `legal` -> `privacy_policy`

#### 11.7 GDPR/DSGVO

一般データ保護規制（ＧＤＰＲ）は、2018年5月25日に発効するＥＵの規制です。​規制の第一の目的は、ＥＵ市民および居住者に個人情報を管理させ、個人情報および個人情報に関するＥＵ内の規制を統一することです。

この規制には、ＥＵ（欧州連合）の「データ主体」（識別された、または識別可能な自然人）の「個人識別情報」（ＰＩＩ）の処理に関する特定の規定が含まれています。​規制に準拠するためには、「企業」（規制によって定義されている）、関連するシステムおよびプロセスは、デフォルトで「設計上のプライバシー」を実装する必要があります、最高のプライバシー設定を使用する必要があります、格納された情報または処理された情報のためにセーフガードを実装する必要があります（「スドニマイゼーション」の実装またはデータの完全な「アノニマイゼーション」を含むがこれらに限定されません）、収集するデータの種類、処理方法、理由、保持期間、および第三者とこのデータを共有するかどうかを明確かつ明白に宣言する必要があります、第三者と共有されるデータの種類、方法、理由などが含まれます。

規制によって定義されているように、合法的な根拠がない限り、データを処理することはできません。​一般的に、これは、合法的な基準でデータ対象のデータを処理するためには、法的義務を遵守しなければならないを意味します、または明示され、十分に情報があり、明白な同意がデータ対象から得られた後にのみ行われる。

規制のいくつかの側面は時間とともに変化する可能性があります。​時代遅れの情報が広がらないようにするには、関係する情報をここに入れるのではなく、正式な情報源から規制について学ぶ方が良いでしょう（ここに含まれる情報が古くなる可能性があります）。

より多くの情報を習得するための推奨リソース：
- [GDPR（EU一般データ保護規制）とは | 語句説明・適用範囲・与える影響を解説](https://boxil.jp/mag/a4605/)
- [EU一般データ保護規則](https://ja.wikipedia.org/wiki/EU%E4%B8%80%E8%88%AC%E3%83%87%E3%83%BC%E3%82%BF%E4%BF%9D%E8%AD%B7%E8%A6%8F%E5%89%87)
- [GDPR（EU一般データ保護規制）対策](https://eizone.info/gdpr/)
- [REGULATION (EU) 2016/679 OF THE EUROPEAN PARLIAMENT AND OF THE COUNCIL](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=celex:32016R0679)
- [GDPRの対象となる個人データとは](https://www.eyjapan.jp/services/advisory/column/2017-06-06.html)

---


最終アップデート：2018年7月14日。
